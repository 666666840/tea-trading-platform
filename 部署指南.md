# èŒ¶å¶ä¸€ç‚¹é€š APIæœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“‹ **éƒ¨ç½²æ¸…å•**

### éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼š
- âœ… server.py (ä¸»APIæœåŠ¡å™¨)
- âœ… app.py (å¤‡ç”¨APIæœåŠ¡å™¨)
- âœ… requirements.txt (Pythonä¾èµ–)
- âœ… deploy-simple.sh (éƒ¨ç½²è„šæœ¬)
- âœ… server-manager.sh (ç®¡ç†è„šæœ¬)

### æœåŠ¡å™¨ä¿¡æ¯ï¼š
- **IPåœ°å€**: 82.157.231.110
- **ç”¨æˆ·å**: root
- **éƒ¨ç½²è·¯å¾„**: /www/wwwroot/tea-api/

## ğŸš€ **éƒ¨ç½²æ­¥éª¤**

### ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ æ–‡ä»¶

**è¯·ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ¯ä¸ªå‘½ä»¤éƒ½éœ€è¦è¾“å…¥æœåŠ¡å™¨å¯†ç ï¼‰ï¼š**

```powershell
# 1. ä¸Šä¼ ä¸»APIæœåŠ¡å™¨
scp server.py root@82.157.231.110:/www/wwwroot/tea-api/

# 2. ä¸Šä¼ å¤‡ç”¨APIæœåŠ¡å™¨  
scp app.py root@82.157.231.110:/www/wwwroot/tea-api/

# 3. ä¸Šä¼ ä¾èµ–æ–‡ä»¶
scp requirements.txt root@82.157.231.110:/www/wwwroot/tea-api/

# 4. ä¸Šä¼ éƒ¨ç½²è„šæœ¬
scp deploy-simple.sh root@82.157.231.110:/www/wwwroot/tea-api/

# 5. ä¸Šä¼ ç®¡ç†è„šæœ¬
scp server-manager.sh root@82.157.231.110:/www/wwwroot/tea-api/
```

### ç¬¬äºŒæ­¥ï¼šè¿æ¥æœåŠ¡å™¨

```powershell
ssh root@82.157.231.110
```

### ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œéƒ¨ç½²

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/tea-api

# è®¾ç½®è„šæœ¬æƒé™
chmod +x deploy-simple.sh
chmod +x server-manager.sh

# æ‰§è¡Œéƒ¨ç½²
./deploy-simple.sh
```

### ç¬¬å››æ­¥ï¼šéªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
./server-manager.sh status

# æµ‹è¯•APIæ¥å£
curl http://localhost:3000/health

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
./server-manager.sh logs
```

## ğŸ”§ **æœåŠ¡ç®¡ç†å‘½ä»¤**

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç®¡ç†APIæœåŠ¡ï¼š

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./server-manager.sh status

# å¯åŠ¨æœåŠ¡
./server-manager.sh start

# åœæ­¢æœåŠ¡
./server-manager.sh stop

# é‡å¯æœåŠ¡
./server-manager.sh restart

# æŸ¥çœ‹æ—¥å¿—
./server-manager.sh logs

# å®æ—¶ç›‘æ§
./server-manager.sh monitor

# æµ‹è¯•APIæ¥å£
./server-manager.sh test
```

## ğŸŒ **APIæœåŠ¡åœ°å€**

éƒ¨ç½²æˆåŠŸåï¼ŒAPIæœåŠ¡å°†åœ¨ä»¥ä¸‹åœ°å€æä¾›æœåŠ¡ï¼š

- **å†…ç½‘åœ°å€**: http://localhost:3000
- **å¤–ç½‘åœ°å€**: http://82.157.231.110:3000

### ä¸»è¦APIæ¥å£ï¼š

1. **å¥åº·æ£€æŸ¥**: `GET /health`
2. **å†…å®¹API**: `GET /api/content?type=recommend`
3. **å¸‚åœºAPI**: `GET /api/market/provinces`
4. **è¯¢ä»·API**: `GET /api/inquiry`
5. **å“ç‰ŒAPI**: `GET /api/brand`
6. **æ¸…ä»“API**: `GET /api/clearance`
7. **æ–°å“API**: `GET /api/newarrival`
8. **èŒ¶å›­API**: `GET /api/garden`
9. **ä¾›æ±‚API**: `GET /api/supply`

## ğŸ” **æ•…éšœæ’é™¤**

### å¸¸è§é—®é¢˜ï¼š

1. **ä¸Šä¼ å¤±è´¥**ï¼š
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤æœåŠ¡å™¨IPå’Œå¯†ç æ­£ç¡®
   - ç¡®ä¿æœåŠ¡å™¨SSHæœåŠ¡æ­£å¸¸

2. **æœåŠ¡å¯åŠ¨å¤±è´¥**ï¼š
   ```bash
   # æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
   cat /www/wwwroot/tea-api/api.log
   
   # æ£€æŸ¥Pythonç¯å¢ƒ
   python3 --version
   
   # æ‰‹åŠ¨å®‰è£…ä¾èµ–
   pip3 install flask flask-cors requests
   ```

3. **ç«¯å£è¢«å ç”¨**ï¼š
   ```bash
   # æŸ¥çœ‹ç«¯å£å ç”¨
   netstat -tlnp | grep :3000
   
   # é‡Šæ”¾ç«¯å£
   pkill -f "python.*server.py"
   ```

4. **APIæ— æ³•è®¿é—®**ï¼š
   ```bash
   # æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   iptables -L
   
   # å¼€æ”¾3000ç«¯å£
   iptables -A INPUT -p tcp --dport 3000 -j ACCEPT
   ```

## ğŸ“Š **æ€§èƒ½ç›‘æ§**

### å®æ—¶ç›‘æ§ï¼š
```bash
# å¯åŠ¨å®æ—¶ç›‘æ§
./server-manager.sh monitor
```

### æ—¥å¿—åˆ†æï¼š
```bash
# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f /www/wwwroot/tea-api/api.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep -i error /www/wwwroot/tea-api/api.log
```

## ğŸ”„ **æ›´æ–°éƒ¨ç½²**

å½“éœ€è¦æ›´æ–°APIæœåŠ¡æ—¶ï¼š

```bash
# 1. åœæ­¢æœåŠ¡
./server-manager.sh stop

# 2. å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp server.py server.py.backup.$(date +%Y%m%d_%H%M%S)

# 3. ä¸Šä¼ æ–°ç‰ˆæœ¬ï¼ˆåœ¨æœ¬åœ°æ‰§è¡Œï¼‰
scp server.py root@82.157.231.110:/www/wwwroot/tea-api/

# 4. é‡å¯æœåŠ¡
./server-manager.sh start

# 5. æµ‹è¯•æ–°ç‰ˆæœ¬
./server-manager.sh test
```

## âœ… **éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•**

- [ ] æ‰€æœ‰æ–‡ä»¶æˆåŠŸä¸Šä¼ 
- [ ] Pythonç¯å¢ƒå’Œä¾èµ–å®‰è£…å®Œæˆ
- [ ] APIæœåŠ¡å¯åŠ¨æˆåŠŸ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] ç«¯å£3000æ­£å¸¸ç›‘å¬
- [ ] ä¸»è¦APIæ¥å£æµ‹è¯•é€šè¿‡
- [ ] å°ç¨‹åºèƒ½æ­£å¸¸è®¿é—®API

## ğŸ“ **æ”¯æŒè”ç³»**

å¦‚é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
- é”™è¯¯æ—¥å¿—å†…å®¹
- æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬
- Pythonç‰ˆæœ¬ä¿¡æ¯
- ç½‘ç»œè¿æ¥çŠ¶æ€ 