# 品类行情模块实现方案

## 功能概述
品类行情模块是茶叶批发平台的核心功能之一，为商户提供价格发布平台，为买家提供实时价格查询服务。该模块实现了完整的价格管理、数据更新、用户查询和可视化展示功能。

## 功能架构

### 1. 商户填报后台

#### 1.1 必填项
- **地级市**：系统定位 + 手动选择
- **茶类**：绿茶/红茶/乌龙茶等
- **具体品类**：如西湖龙井/金骏眉
- **价格区间**：最低价-最高价

#### 1.2 选填项
- **茶叶实拍图**：≤3张
- **工艺说明**：制作工艺、特点描述
- **产地**：茶叶产地信息

#### 1.3 激励提示
- 上传实拍图：买家咨询量提升2倍，获得「实拍」标
- 填写产地信息：获得「齐全」标
- 工艺说明：提升曝光权重

#### 1.4 快速更新功能
- 价格未变时的便捷操作
- 一键更新时间戳
- 计入商户活跃度积分

### 2. 平台数据处理

#### 2.1 价格区间生成
- 每日7:00自动计算
- 示例：黄山市祁门红茶 = 360-620元/斤

#### 2.2 数据保鲜机制
- **24小时内更新**：绿色标签「今日更新」
- **超72小时未更新**：灰色小字标注「3天未更新」
- **随时可修改**：实时生效，显示"X分钟前更新"

#### 2.3 更新提醒系统
- **每日强制提醒**：上午9:00推送
- **动态内容**：替换产品名和未更新天数
- **便捷操作**：一键快速更新

### 3. 用户端功能

#### 3.1 价格查询
- 查看地级市价格区间
- 点击价格跳转品类报价列表
- 显示条目：价格+工艺+产地+图片

#### 3.2 排序功能
- **按价格排序**：低→高 / 高→低
- **按好评排序**：综合评分、咨询量、收藏数
- **按距离排序**：基于用户位置

#### 3.3 行情地图
- 全国价格分布可视化
- 地图标记点显示价格信息
- 支持筛选和趋势查看

### 4. 风控与保障

#### 4.1 数据真实性
- 强制标注："本报价由商户提供，仅供参考"
- 信息完整性评分
- 商户信誉度评估

#### 4.2 开放功能
- 免费查看各地均价趋势图
- 价格历史变化分析
- 市场热度统计

## 技术实现

### 1. 页面结构
```
pages/
├── market-price/              # 类目行情列表页
├── market-price-detail/       # 价格详情页
├── market-map/               # 行情地图页
└── publish-price/            # 发布价格页
```

### 2. 核心功能实现

#### 2.1 排序算法
```javascript
// 推荐排序：综合评分、更新时间、完整性
calculateRecommendScore(item) {
  let score = 0
  score += this.calculateRatingScore(item)
  
  // 信息完整性加分
  if (item.hasImages) score += 15
  if (item.hasOrigin) score += 10
  if (item.process) score += 5
  
  // 更新时间权重
  if (item.updateStatus === 'updated') score += 30
  else if (item.updateStatus === 'recent') score += 20
  else if (item.updateStatus === 'outdated') score -= 20
  
  return score
}
```

#### 2.2 激励系统
```javascript
// 激励提示更新
updateIncentives() {
  const incentives = {
    images: {
      completed: this.data.formData.images.length > 0,
      reward: '获得「实拍」标'
    },
    origin: {
      completed: !!this.data.formData.origin,
      reward: '获得「齐全」标'
    },
    process: {
      completed: !!this.data.formData.process,
      reward: '提升曝光权重'
    }
  }
  this.setData({ incentives })
}
```

#### 2.3 地图功能
```javascript
// 地图标记更新
updateMapMarkers() {
  const markers = this.data.mapData.map(item => ({
    id: item.id,
    latitude: item.latitude,
    longitude: item.longitude,
    title: `${item.city} ${item.subCategory}`,
    iconPath: this.getMarkerIcon(item.status),
    callout: {
      content: `${item.city}\n${item.subCategory}\n${item.priceRange}${item.unit}`,
      display: 'BYCLICK'
    }
  }))
  this.setData({ 'mapConfig.markers': markers })
}
```

### 3. 数据流程

#### 3.1 商户发布流程
1. 选择城市和茶类
2. 填写价格区间
3. 上传图片和补充信息
4. 系统验证和保存
5. 实时更新到用户端

#### 3.2 用户查询流程
1. 选择地区和茶类
2. 查看价格列表
3. 应用排序筛选
4. 查看详情或联系商户

#### 3.3 数据更新流程
1. 系统定时检查更新状态
2. 发送更新提醒
3. 商户快速更新
4. 实时同步到前端

## 用户体验优化

### 1. 界面设计
- 清晰的信息层级
- 直观的状态标识
- 便捷的操作流程

### 2. 交互优化
- 下拉排序选择
- 快速更新按钮
- 地图可视化展示

### 3. 性能优化
- 懒加载数据
- 缓存机制
- 分页加载

## 安全与合规

### 1. 数据安全
- 用户信息加密
- 权限控制
- 数据备份

### 2. 内容审核
- 价格合理性检查
- 图片内容审核
- 商户资质验证

### 3. 合规要求
- 价格信息真实性
- 用户隐私保护
- 平台责任声明

## 后续优化方向

### 1. 功能扩展
- AI价格预测
- 智能推荐
- 供应链追踪

### 2. 技术升级
- 实时数据同步
- 大数据分析
- 机器学习应用

### 3. 用户体验
- 个性化推荐
- 社交功能
- 移动端优化

## 总结

品类行情模块通过完整的功能设计和用户体验优化，为茶叶批发市场提供了高效的价格信息服务平台。该模块不仅满足了商户发布和用户查询的基本需求，还通过激励机制和智能排序提升了平台的活跃度和用户粘性。

通过持续的技术优化和功能迭代，该模块将为茶叶批发行业的信息化发展提供强有力的支撑。 