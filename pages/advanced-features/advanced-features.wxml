<!-- é«˜ä¼˜å…ˆçº§åŠŸèƒ½æ¼”ç¤ºé¡µé¢ -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ğŸš€ é«˜ä¼˜å…ˆçº§åŠŸèƒ½æ¼”ç¤º</text>
    <text class="page-subtitle">Advanced Features Demo</text>
  </view>

  <!-- åŠŸèƒ½æ ‡ç­¾æ  -->
  <view class="tabs-container">
    <scroll-view class="tabs-scroll" scroll-x="true">
      <view class="tabs">
        <view 
          wx:for="{{tabs}}" 
          wx:key="id"
          class="tab {{activeTab === item.id ? 'active' : ''}}"
          data-tab="{{item.id}}"
          bindtap="onTabChange"
        >
          <text class="tab-icon">{{item.icon}}</text>
          <text class="tab-name">{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åŠŸèƒ½æ¼”ç¤ºå†…å®¹ -->
  <view class="demo-content">
    <!-- æ™ºèƒ½æœç´¢æ¼”ç¤º -->
    <view wx:if="{{activeTab === 'search'}}" class="demo-section">
      <view class="section-header">
        <text class="section-title">ğŸ” æ™ºèƒ½æœç´¢ç³»ç»Ÿ</text>
        <text class="section-desc">è¯­ä¹‰æœç´¢ã€æ‹¼éŸ³æœç´¢ã€æ™ºèƒ½æ¨è</text>
      </view>

      <!-- æœç´¢è¾“å…¥ -->
      <view class="search-demo">
        <view class="search-input-container">
          <input 
            class="search-input" 
            placeholder="è¾“å…¥æœç´¢å…³é”®è¯..."
            value="{{searchDemoData.keyword}}"
            bindinput="onSearchInput"
          />
          <button 
            class="search-btn {{searchDemoData.isSearching ? 'loading' : ''}}"
            bindtap="performAdvancedSearch"
          >
            {{searchDemoData.isSearching ? 'æœç´¢ä¸­...' : 'æœç´¢'}}
          </button>
        </view>

        <!-- æœç´¢å»ºè®® -->
        <view wx:if="{{searchDemoData.searchSuggestions.length > 0}}" class="search-suggestions">
          <text class="suggestions-title">æœç´¢å»ºè®®:</text>
          <view class="suggestions-list">
            <text 
              wx:for="{{searchDemoData.searchSuggestions}}" 
              wx:key="*this"
              class="suggestion-item"
            >
              {{item}}
            </text>
          </view>
        </view>

        <!-- æœç´¢ç»“æœ -->
        <view wx:if="{{searchDemoData.searchResults.length > 0}}" class="search-results">
          <text class="results-title">æœç´¢ç»“æœ ({{searchDemoData.searchResults.length}})</text>
          <view class="results-list">
            <view 
              wx:for="{{searchDemoData.searchResults}}" 
              wx:key="id"
              class="result-item"
              data-type="search_result"
              data-id="{{item.id}}"
              bindtap="viewDetails"
            >
              <text class="result-title">{{item.title}}</text>
              <text class="result-desc">{{item.description}}</text>
              <text class="result-score">ç›¸å…³åº¦: {{item.score}}%</text>
            </view>
          </view>
        </view>

        <!-- æœç´¢ç»Ÿè®¡ -->
        <view wx:if="{{searchDemoData.searchAnalytics}}" class="search-analytics">
          <text class="analytics-title">æœç´¢ç»Ÿè®¡</text>
          <view class="analytics-grid">
            <view class="analytics-item">
              <text class="analytics-label">æ€»æœç´¢æ¬¡æ•°</text>
              <text class="analytics-value">{{searchDemoData.searchAnalytics.totalSearches}}</text>
            </view>
            <view class="analytics-item">
              <text class="analytics-label">çƒ­é—¨å…³é”®è¯</text>
              <text class="analytics-value">{{searchDemoData.searchAnalytics.topKeywords[0] || 'æš‚æ— '}}</text>
            </view>
          </view>
        </view>

        <!-- æ“ä½œæŒ‰é’® -->
        <view class="demo-actions">
          <button class="action-btn secondary" bindtap="clearSearchHistory">æ¸…é™¤å†å²</button>
        </view>
      </view>
    </view>

    <!-- æ”¯ä»˜ç³»ç»Ÿæ¼”ç¤º -->
    <view wx:if="{{activeTab === 'payment'}}" class="demo-section">
      <view class="section-header">
        <text class="section-title">ğŸ’³ æ”¯ä»˜ç³»ç»Ÿ</text>
        <text class="section-desc">è®¢å•ç®¡ç†ã€å¤šç§æ”¯ä»˜æ–¹å¼ã€é’±åŒ…åŠŸèƒ½</text>
      </view>

      <!-- ç”¨æˆ·é’±åŒ… -->
      <view wx:if="{{paymentDemoData.userWallet}}" class="wallet-info">
        <view class="wallet-header">
          <text class="wallet-title">ğŸ’° æˆ‘çš„é’±åŒ…</text>
        </view>
        <view class="wallet-balance">
          <text class="balance-label">ä½™é¢</text>
          <text class="balance-amount">Â¥{{paymentDemoData.userWallet.balance}}</text>
        </view>
      </view>

      <!-- æ¼”ç¤ºè®¢å• -->
      <view class="order-demo">
        <view wx:if="{{!paymentDemoData.demoOrder}}" class="create-order">
          <button class="action-btn primary" bindtap="createDemoOrder">åˆ›å»ºæ¼”ç¤ºè®¢å•</button>
        </view>
        
        <view wx:if="{{paymentDemoData.demoOrder}}" class="order-info">
          <text class="order-title">ğŸ“‹ è®¢å•ä¿¡æ¯</text>
          <view class="order-details">
            <text class="order-id">è®¢å•å·: {{paymentDemoData.demoOrder.id}}</text>
            <text class="order-product">å•†å“: {{paymentDemoData.demoOrder.productName}}</text>
            <text class="order-amount">é‡‘é¢: Â¥{{paymentDemoData.demoOrder.paymentInfo.totalAmount}}</text>
            <text class="order-status">çŠ¶æ€: {{paymentDemoData.demoOrder.status}}</text>
          </view>
        </view>
      </view>

      <!-- æ”¯ä»˜æ–¹å¼ -->
      <view wx:if="{{paymentDemoData.demoOrder}}" class="payment-methods">
        <text class="methods-title">é€‰æ‹©æ”¯ä»˜æ–¹å¼</text>
        <view class="methods-grid">
          <view 
            wx:for="{{paymentDemoData.paymentMethods}}" 
            wx:key="id"
            class="payment-method"
            data-method="{{item.id}}"
            bindtap="demoPay"
          >
            <text class="method-icon">{{item.icon}}</text>
            <text class="method-name">{{item.name}}</text>
          </view>
        </view>
      </view>

      <!-- æ”¯ä»˜ç»Ÿè®¡ -->
      <view wx:if="{{paymentDemoData.paymentStats}}" class="payment-stats">
        <text class="stats-title">æ”¯ä»˜ç»Ÿè®¡</text>
        <view class="stats-grid">
          <view class="stats-item">
            <text class="stats-label">æ€»è®¢å•æ•°</text>
            <text class="stats-value">{{paymentDemoData.paymentStats.totalOrders}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">æˆåŠŸæ”¯ä»˜</text>
            <text class="stats-value">{{paymentDemoData.paymentStats.successfulPayments}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">æ”¯ä»˜æˆåŠŸç‡</text>
            <text class="stats-value">{{paymentDemoData.paymentStats.successRate}}%</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å®æ—¶é€šä¿¡æ¼”ç¤º -->
    <view wx:if="{{activeTab === 'realtime'}}" class="demo-section">
      <view class="section-header">
        <text class="section-title">ğŸ’¬ å®æ—¶é€šä¿¡ç³»ç»Ÿ</text>
        <text class="section-desc">å³æ—¶æ¶ˆæ¯ã€åœ¨çº¿çŠ¶æ€ã€è¿æ¥ç®¡ç†</text>
      </view>

      <!-- è¿æ¥çŠ¶æ€ -->
      <view class="connection-status">
        <view class="status-header">
          <text class="status-title">è¿æ¥çŠ¶æ€</text>
          <text class="status-indicator {{realtimeDemoData.connectionState.connected ? 'connected' : 'disconnected'}}">
            {{realtimeDemoData.connectionState.connected ? 'å·²è¿æ¥' : 'æœªè¿æ¥'}}
          </text>
        </view>
        <button class="action-btn secondary" bindtap="testRealtimeConnection">æµ‹è¯•è¿æ¥</button>
      </view>

      <!-- æ¶ˆæ¯æ¼”ç¤º -->
      <view class="message-demo">
        <view class="message-header">
          <text class="message-title">æ¶ˆæ¯æ¼”ç¤º</text>
          <button class="action-btn primary" bindtap="sendDemoMessage">å‘é€æ¶ˆæ¯</button>
        </view>
        
        <view wx:if="{{realtimeDemoData.messages.length > 0}}" class="message-list">
          <view 
            wx:for="{{realtimeDemoData.messages}}" 
            wx:key="id"
            class="message-item"
          >
            <text class="message-content">{{item.content}}</text>
            <text class="message-time">{{item.timestamp}}</text>
          </view>
        </view>
      </view>

      <!-- å®æ—¶ç»Ÿè®¡ -->
      <view wx:if="{{realtimeDemoData.realtimeStats}}" class="realtime-stats">
        <text class="stats-title">å®æ—¶ç»Ÿè®¡</text>
        <view class="stats-grid">
          <view class="stats-item">
            <text class="stats-label">æ€»æ¶ˆæ¯æ•°</text>
            <text class="stats-value">{{realtimeDemoData.realtimeStats.totalMessages}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">ä¼šè¯æ•°</text>
            <text class="stats-value">{{realtimeDemoData.realtimeStats.totalConversations}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">åœ¨çº¿ç”¨æˆ·</text>
            <text class="stats-value">{{realtimeDemoData.realtimeStats.onlineUsersCount}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ€§èƒ½ç›‘æ§æ¼”ç¤º -->
    <view wx:if="{{activeTab === 'performance'}}" class="demo-section">
      <view class="section-header">
        <text class="section-title">ğŸ“Š æ€§èƒ½ç›‘æ§ç³»ç»Ÿ</text>
        <text class="section-desc">å®æ—¶ç›‘æ§ã€æ€§èƒ½åˆ†æã€è‡ªåŠ¨ä¼˜åŒ–</text>
      </view>

      <!-- ç›‘æ§çŠ¶æ€ -->
      <view wx:if="{{performanceDemoData.monitoringStatus}}" class="monitoring-status">
        <text class="status-title">ç›‘æ§çŠ¶æ€</text>
        <view class="status-info">
          <text class="status-item">
            çŠ¶æ€: {{performanceDemoData.monitoringStatus.enabled ? 'è¿è¡Œä¸­' : 'å·²åœæ­¢'}}
          </text>
          <text class="status-item">
            è¿è¡Œæ—¶é—´: {{performanceDemoData.monitoringStatus.uptime}}ms
          </text>
        </view>
      </view>

      <!-- æ€§èƒ½æŒ‡æ ‡ -->
      <view wx:if="{{performanceDemoData.performanceReport}}" class="performance-metrics">
        <text class="metrics-title">æ€§èƒ½æŒ‡æ ‡</text>
        <view class="metrics-grid">
          <view class="metrics-item">
            <text class="metrics-label">é¡µé¢åŠ è½½æ—¶é—´</text>
            <text class="metrics-value">{{performanceDemoData.performanceReport.summary.avgLoadTime || 0}}ms</text>
          </view>
          <view class="metrics-item">
            <text class="metrics-label">APIå“åº”æ—¶é—´</text>
            <text class="metrics-value">{{performanceDemoData.performanceReport.summary.avgApiTime || 0}}ms</text>
          </view>
          <view class="metrics-item">
            <text class="metrics-label">å†…å­˜ä½¿ç”¨ç‡</text>
            <text class="metrics-value">{{performanceDemoData.performanceReport.summary.memoryUsage || 0}}%</text>
          </view>
        </view>
      </view>

      <!-- ä¼˜åŒ–å»ºè®® -->
      <view wx:if="{{performanceDemoData.optimizationSuggestions.length > 0}}" class="optimization-suggestions">
        <text class="suggestions-title">ä¼˜åŒ–å»ºè®®</text>
        <view class="suggestions-list">
          <view 
            wx:for="{{performanceDemoData.optimizationSuggestions}}" 
            wx:key="type"
            class="suggestion-item"
          >
            <text class="suggestion-title">{{item.title}}</text>
            <text class="suggestion-desc">{{item.description}}</text>
            <text class="suggestion-priority priority-{{item.priority}}">{{item.priority}}</text>
          </view>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="demo-actions">
        <button class="action-btn primary" bindtap="performOptimization">æ‰§è¡Œä¼˜åŒ–</button>
        <button class="action-btn secondary" bindtap="simulatePerformanceTest">æ¨¡æ‹Ÿæµ‹è¯•</button>
      </view>
    </view>

    <!-- å®‰å…¨ç½‘å…³æ¼”ç¤º -->
    <view wx:if="{{activeTab === 'security'}}" class="demo-section">
      <view class="section-header">
        <text class="section-title">ğŸ”’ å®‰å…¨ç½‘å…³</text>
        <text class="section-desc">è¯·æ±‚æ‹¦æˆªã€å®‰å…¨éªŒè¯ã€æµé‡æ§åˆ¶</text>
      </view>

      <!-- å®‰å…¨ç»Ÿè®¡ -->
      <view wx:if="{{securityDemoData.securityReport}}" class="security-stats">
        <text class="stats-title">å®‰å…¨ç»Ÿè®¡</text>
        <view class="stats-grid">
          <view class="stats-item">
            <text class="stats-label">æ€»è¯·æ±‚æ•°</text>
            <text class="stats-value">{{securityDemoData.securityReport.monitoring.totalRequests}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">æˆåŠŸè¯·æ±‚</text>
            <text class="stats-value">{{securityDemoData.securityReport.monitoring.successRequests}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">è¢«æ‹¦æˆª</text>
            <text class="stats-value">{{securityDemoData.securityReport.monitoring.blockedRequests}}</text>
          </view>
          <view class="stats-item">
            <text class="stats-label">å¹³å‡å“åº”æ—¶é—´</text>
            <text class="stats-value">{{securityDemoData.securityReport.monitoring.avgResponseTime}}ms</text>
          </view>
        </view>
      </view>

      <!-- å®‰å…¨äº‹ä»¶ -->
      <view wx:if="{{securityDemoData.recentAlerts.length > 0}}" class="security-alerts">
        <text class="alerts-title">æœ€è¿‘å®‰å…¨äº‹ä»¶</text>
        <view class="alerts-list">
          <view 
            wx:for="{{securityDemoData.recentAlerts}}" 
            wx:key="id"
            class="alert-item severity-{{item.severity}}"
          >
            <text class="alert-event">{{item.event}}</text>
            <text class="alert-time">{{item.timestamp}}</text>
            <text class="alert-severity">{{item.severity}}</text>
          </view>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="demo-actions">
        <button class="action-btn primary" bindtap="testSecureRequest">æµ‹è¯•å®‰å…¨è¯·æ±‚</button>
        <button class="action-btn secondary" bindtap="simulateSecurityEvent">æ¨¡æ‹Ÿå®‰å…¨äº‹ä»¶</button>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨åŠŸèƒ½è¯´æ˜ -->
  <view class="footer-info">
    <text class="footer-text">ğŸš€ è¿™äº›æ˜¯èŒ¶å¶æ‰¹å‘å°ç¨‹åºçš„é«˜ä¼˜å…ˆçº§åŠŸèƒ½æ¼”ç¤º</text>
    <text class="footer-text">âœ¨ åŒ…å«æ™ºèƒ½æœç´¢ã€æ”¯ä»˜ç³»ç»Ÿã€å®æ—¶é€šä¿¡ã€æ€§èƒ½ç›‘æ§å’Œå®‰å…¨ç½‘å…³</text>
  </view>
</view> 