<view class="detail-container" wx:if="{{clearanceInfo}}">
  <!-- ç‰¹ä»·æç¤º -->
  <view class="special-notice">
    <text class="notice-text">âš ï¸ ç‰¹ä»·å“ä¸æ”¯æŒé€€æ¢ï¼Œè¯·éªŒè´§åäº¤æ˜“</text>
  </view>

  <!-- å•†å“å›¾ç‰‡è½®æ’­ -->
  <swiper class="image-swiper" indicator-dots="{{true}}" autoplay="{{false}}">
    <swiper-item wx:for="{{clearanceInfo.images}}" wx:key="index">
      <image class="swiper-image" 
             src="{{item}}" 
             mode="aspectFill"
             data-index="{{index}}"
             bindtap="previewImage" />
    </swiper-item>
  </swiper>

  <!-- å•†å“åŸºæœ¬ä¿¡æ¯ -->
  <view class="info-section">
    <view class="product-title">{{clearanceInfo.name}}</view>
    
    <!-- ä»·æ ¼ä¿¡æ¯ -->
    <view class="price-section">
      <text class="original-price">Â¥{{clearanceInfo.originalPrice}}</text>
      <text class="clearance-price">Â¥{{clearanceInfo.clearancePrice}}</text>
      <text class="discount-tag">
        {{Math.floor((clearanceInfo.originalPrice - clearanceInfo.clearancePrice) / clearanceInfo.originalPrice * 100)}}%OFF
      </text>
    </view>

    <!-- åº“å­˜ä¿¡æ¯ -->
    <view class="stock-section">
      <view class="stock-info">
        <text class="stock-text">åº“å­˜ï¼š{{clearanceInfo.stockText}}</text>
        <text class="stock-range">({{clearanceInfo.stockMin}}-{{clearanceInfo.stockMax}}æ–¤)</text>
      </view>
      <view class="stock-bar">
        <view class="stock-progress" style="width: {{clearanceInfo.stockPercent}}%"></view>
      </view>
      <text class="stock-percent">å‰©ä½™{{clearanceInfo.stockPercent}}%</text>
    </view>

    <!-- æ¸…ä»“åŸå›  -->
    <view class="reason-section">
      <text class="reason-label">æ¸…ä»“åŸå› ï¼š</text>
      <text class="reason-text">{{clearanceInfo.reason}}</text>
    </view>

    <!-- å€’è®¡æ—¶ -->
    <view class="countdown-section">
      <text class="countdown-label">é™æ—¶ç‰¹ä»·</text>
      <text class="countdown-time">{{countdownText}}</text>
    </view>

    <!-- å…³æ³¨äººæ•° -->
    <view class="viewers-section">
      <text class="viewers-text">{{clearanceInfo.viewers}}äººæ­£åœ¨å…³æ³¨</text>
    </view>
  </view>

  <!-- å•†å“æè¿° -->
  <view class="description-section">
    <view class="section-title">å•†å“æè¿°</view>
    <view class="description-content">{{clearanceInfo.description}}</view>
  </view>

  <!-- å•†æˆ·ä¿¡æ¯ -->
  <view class="merchant-section">
    <view class="section-title">å•†æˆ·ä¿¡æ¯</view>
    <view class="merchant-info">
      <image class="merchant-avatar" src="{{merchantInfo.avatar}}" mode="aspectFill" />
      <view class="merchant-details">
        <view class="merchant-name">{{merchantInfo.name}}</view>
        <view class="merchant-rating">
          <text class="rating-text">ä¿¡ç”¨è¯„åˆ†ï¼š{{merchantInfo.rating}}</text>
          <text class="rating-stars">â˜…â˜…â˜…â˜…â˜…</text>
        </view>
        <view class="merchant-stats">
          <text class="stats-text">å·²å‘å¸ƒ{{merchantInfo.clearanceCount}}æ¬¡ç‰¹ä»·</text>
          <text class="stats-text">å…¥é©»æ—¶é—´ï¼š{{merchantInfo.joinTime}}</text>
        </view>
      </view>
    </view>

    <!-- è”ç³»æ–¹å¼ -->
    <view class="contact-section">
      <view class="contact-title">è”ç³»æ–¹å¼</view>
      <view class="contact-buttons">
        <button class="contact-btn phone-btn {{!isUnlocked ? 'locked' : ''}}" 
                bindtap="callMerchant">
          <text class="btn-icon">ğŸ“</text>
          <text class="btn-text">{{isUnlocked ? 'æ‹¨æ‰“ç”µè¯' : 'è§£é”ç”µè¯'}}</text>
        </button>
        <button class="contact-btn wechat-btn {{!isUnlocked ? 'locked' : ''}}" 
                bindtap="copyWechat">
          <text class="btn-icon">ğŸ’¬</text>
          <text class="btn-text">{{isUnlocked ? 'å¤åˆ¶å¾®ä¿¡' : 'è§£é”å¾®ä¿¡'}}</text>
        </button>
      </view>
      <view class="contact-tip" wx:if="{{!isUnlocked}}">
        <text class="tip-text">ç‚¹å‡»æŒ‰é’®è§£é”å•†æˆ·è”ç³»æ–¹å¼</text>
      </view>
    </view>
  </view>

  <!-- å†å²æ¸…ä»“è®°å½• -->
  <view class="history-section">
    <view class="section-title">å†å²æ¸…ä»“è®°å½•</view>
    <view class="history-list">
      <view class="history-item" wx:for="{{historyClearance}}" wx:key="id">
        <view class="history-info">
          <text class="history-name">{{item.name}}</text>
          <text class="history-price">Â¥{{item.price}}/æ–¤</text>
        </view>
        <view class="history-meta">
          <text class="history-date">{{item.date}}</text>
          <text class="history-status">{{item.status}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å‘å¸ƒä¿¡æ¯ -->
  <view class="publish-info">
    <text class="publish-text">å‘å¸ƒæ—¶é—´ï¼š{{clearanceInfo.createTime}}</text>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:else>
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view> 