<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-left">
      <text class="header-title">çŸ¥åå“ç‰Œ</text>
      <text class="header-subtitle">å“è´¨ä¿è¯ï¼Œå“ç‰Œè®¤è¯</text>
    </view>
    <view class="header-right">
      <button class="join-btn" bindtap="showJoinInfo">
        <text class="btn-icon">ğŸ¢</text>
        <text class="btn-text">å“ç‰Œå…¥é©»</text>
      </button>
    </view>
  </view>

  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <button class="filter-btn" bindtap="toggleFilterPanel">
      <text class="btn-icon">ğŸ”</text>
      <text class="btn-text">{{filters.category}} Â· {{filters.region}}</text>
      <text class="btn-arrow">{{showFilterPanel ? 'â–²' : 'â–¼'}}</text>
    </button>
  </view>

  <!-- ç­›é€‰é¢æ¿ -->
  <view class="filter-panel" wx:if="{{showFilterPanel}}">
    <!-- èŒ¶ç±»ç­›é€‰ -->
    <view class="filter-group">
      <text class="group-title">èŒ¶ç±»</text>
      <view class="option-list">
        <text class="option-item {{filters.category === category ? 'active' : ''}}" 
              wx:for="{{teaCategories}}" 
              wx:key="*this"
              wx:for-item="category"
              bindtap="selectFilter"
              data-type="category"
              data-value="{{category}}">
          {{category}}
        </text>
      </view>
    </view>
    
    <!-- åœ°åŒºç­›é€‰ -->
    <view class="filter-group">
      <text class="group-title">åœ°åŒº</text>
      <view class="option-list">
        <text class="option-item {{filters.region === region ? 'active' : ''}}" 
              wx:for="{{regions}}" 
              wx:key="*this"
              wx:for-item="region"
              bindtap="selectFilter"
              data-type="region"
              data-value="{{region}}">
          {{region}}
        </text>
      </view>
    </view>
    
    <!-- è®¤è¯ç­›é€‰ -->
    <view class="filter-group">
      <text class="group-title">è®¤è¯</text>
      <view class="option-list">
        <text class="option-item {{filters.certification === certification ? 'active' : ''}}" 
              wx:for="{{certifications}}" 
              wx:key="*this"
              wx:for-item="certification"
              bindtap="selectFilter"
              data-type="certification"
              data-value="{{certification}}">
          {{certification}}
        </text>
      </view>
    </view>
  </view>

  <!-- å“ç‰Œåˆ—è¡¨ -->
  <view class="brand-list" wx:if="{{filteredBrands.length > 0}}">
    <view class="brand-item" 
          wx:for="{{filteredBrands}}" 
          wx:key="id"
          wx:for-item="brand">
      
      <!-- å“ç‰Œå¡ç‰‡å¤´éƒ¨ -->
      <view class="brand-header">
        <view class="brand-logo">
          <image class="logo-image" src="{{brand.logo}}" mode="aspectFit"></image>
        </view>
        <view class="brand-info">
          <view class="brand-name">
            <text class="name-text">{{brand.name}}</text>
            <view class="certification-badges">
              <text class="badge national" wx:if="{{brand.isNationalBrand}}">å›½å“è®¤è¯</text>
              <text class="badge certified" wx:if="{{brand.isCertified}}">å“ç‰Œè®¤è¯</text>
            </view>
          </view>
          <text class="brand-slogan">{{brand.slogan}}</text>
          <view class="brand-meta">
            <text class="meta-item">åˆ›ç«‹äº{{brand.foundedYear}}å¹´</text>
            <text class="meta-item">{{brand.headquarters}}</text>
          </view>
        </view>
      </view>
      
      <!-- å“ç‰Œå¡ç‰‡å†…å®¹ -->
      <view class="brand-content">
        <view class="brand-stats">
          <view class="stat-item">
            <text class="stat-label">å¹´äº§é‡</text>
            <text class="stat-value">{{brand.annualOutput}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">è¦†ç›–å¸‚åœº</text>
            <text class="stat-value">{{brand.marketCoverage}}ä¸ª</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">æ ¸å¿ƒäº§åŒº</text>
            <text class="stat-value">{{brand.coreRegion}}</text>
          </view>
        </view>
        
        <view class="brand-description">
          <text class="desc-text">{{brand.description}}</text>
        </view>
        
        <!-- è®¤è¯æ ‡ç­¾ -->
        <view class="certification-tags">
          <text class="cert-tag" 
                wx:for="{{brand.certifications}}" 
                wx:key="*this"
                wx:for-item="cert">
            {{cert}}
          </text>
        </view>
        
        <!-- äº§å“çº¿ -->
        <view class="product-lines">
          <text class="line-label">äº§å“çº¿ï¼š</text>
          <text class="line-item" 
                wx:for="{{brand.productLines}}" 
                wx:key="*this"
                wx:for-item="line">
            {{line}}
          </text>
        </view>
      </view>
      
      <!-- å“ç‰Œå¡ç‰‡åº•éƒ¨ -->
      <view class="brand-footer">
        <view class="footer-left">
          <button class="detail-btn" bindtap="viewBrandDetail" data-id="{{brand.id}}">
            <text class="btn-text">å“ç‰Œè¯¦æƒ…</text>
            <text class="btn-arrow">â†’</text>
          </button>
        </view>
        <view class="footer-right">
          <button class="map-btn" bindtap="viewDealerMap" data-id="{{brand.id}}">
            <text class="btn-icon">ğŸ—ºï¸</text>
            <text class="btn-text">ç»é”€å•†åœ°å›¾</text>
          </button>
          <button class="claim-btn" bindtap="applyBrandClaim" data-id="{{brand.id}}">
            <text class="btn-icon">ğŸ“‹</text>
            <text class="btn-text">ç”³è¯·è®¤é¢†</text>
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{filteredBrands.length === 0}}">
    <view class="empty-icon">ğŸ·ï¸</view>
    <text class="empty-title">æš‚æ— ç›¸å…³å“ç‰Œ</text>
    <text class="empty-desc">è¯·å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–ç¨åå†è¯•</text>
  </view>

  <!-- å“ç‰Œè¯¦æƒ…å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showBrandDetail}}" bindtap="closeBrandDetail">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">å“ç‰Œè¯¦æƒ…</text>
        <text class="modal-close" bindtap="closeBrandDetail">Ã—</text>
      </view>
      
      <view class="modal-body" wx:if="{{selectedBrand}}">
        <view class="detail-section">
          <text class="section-title">å“ç‰Œä¿¡æ¯</text>
          <view class="info-list">
            <view class="info-item">
              <text class="info-label">å“ç‰Œåç§°</text>
              <text class="info-value">{{selectedBrand.name}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">åˆ›ç«‹å¹´ä»½</text>
              <text class="info-value">{{selectedBrand.foundedYear}}å¹´</text>
            </view>
            <view class="info-item">
              <text class="info-label">æ€»éƒ¨åœ°å€</text>
              <text class="info-value">{{selectedBrand.headquarters}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">æ ¸å¿ƒäº§åŒº</text>
              <text class="info-value">{{selectedBrand.coreRegion}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">å¹´äº§é‡</text>
              <text class="info-value">{{selectedBrand.annualOutput}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">è¦†ç›–å¸‚åœº</text>
              <text class="info-value">{{selectedBrand.marketCoverage}}ä¸ª</text>
            </view>
          </view>
        </view>
        
        <view class="detail-section">
          <text class="section-title">è®¤è¯èµ„è´¨</text>
          <view class="certification-list">
            <text class="cert-item" 
                  wx:for="{{selectedBrand.certifications}}" 
                  wx:key="*this"
                  wx:for-item="cert">
              {{cert}}
            </text>
          </view>
        </view>
        
        <view class="detail-section">
          <text class="section-title">äº§å“çº¿</text>
          <view class="product-list">
            <text class="product-item" 
                  wx:for="{{selectedBrand.productLines}}" 
                  wx:key="*this"
                  wx:for-item="line">
              {{line}}
            </text>
          </view>
        </view>
        
        <view class="detail-section">
          <text class="section-title">å“ç‰Œçºªäº‹</text>
          <text class="brand-story">{{selectedBrand.description}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»é”€å•†åœ°å›¾å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showDealerMap}}" bindtap="closeDealerMap">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ç»é”€å•†ç½‘ç»œ</text>
        <text class="modal-close" bindtap="closeDealerMap">Ã—</text>
      </view>
      
      <view class="modal-body" wx:if="{{selectedBrand}}">
        <view class="dealer-list">
          <view class="dealer-item" 
                wx:for="{{selectedBrand.dealers}}" 
                wx:key="id"
                wx:for-item="dealer">
            
            <view class="dealer-info">
              <text class="dealer-name">{{dealer.name}}</text>
              <text class="dealer-address">{{dealer.address}}</text>
              <view class="dealer-meta">
                <text class="distance" wx:if="{{locationAuthorized}}">{{dealer.distance}}km</text>
                <text class="pickup-tag" wx:if="{{dealer.canPickup}}">å¯åˆ°åº—è‡ªæ</text>
              </view>
            </view>
            
            <view class="dealer-actions">
              <button class="contact-btn" 
                      bindtap="contactDealer" 
                      data-phone="{{dealer.phone}}">
                <text class="btn-icon">ğŸ“</text>
                <text class="btn-text">è”ç³»</text>
              </button>
              <button class="navigate-btn" 
                      bindtap="navigateToDealer" 
                      data-coordinates="{{dealer.coordinates}}"
                      data-name="{{dealer.name}}">
                <text class="btn-icon">ğŸ“</text>
                <text class="btn-text">å¯¼èˆª</text>
              </button>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è®¤é¢†ç”³è¯·å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showClaimForm}}" bindtap="closeClaimForm">
    <view class="modal-content claim-form" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ç”³è¯·å“ç‰Œè®¤é¢†</text>
        <text class="modal-close" bindtap="closeClaimForm">Ã—</text>
      </view>
      
      <view class="modal-body" wx:if="{{selectedBrand}}">
        <view class="form-section">
          <text class="section-title">ç”³è¯·è®¤é¢†ï¼š{{selectedBrand.name}}</text>
        </view>
        
        <view class="form-section">
          <text class="form-label">è®¤é¢†äººä¿¡æ¯</text>
          <input class="form-input" 
                 placeholder="å¾®ä¿¡æ˜µç§°" 
                 value="{{claimForm.wechatName}}"
                 data-field="wechatName"
                 bindinput="inputClaimForm" />
          <input class="form-input" 
                 placeholder="çœŸå®å§“å" 
                 value="{{claimForm.realName}}"
                 data-field="realName"
                 bindinput="inputClaimForm" />
          <input class="form-input" 
                 placeholder="æ‰‹æœºå·ç " 
                 value="{{claimForm.phone}}"
                 data-field="phone"
                 bindinput="inputClaimForm" />
        </view>
        
        <view class="form-section">
          <text class="form-label">ä¼ä¸šä¿¡æ¯</text>
          <input class="form-input" 
                 placeholder="å•†æˆ·åç§°" 
                 value="{{claimForm.merchantName}}"
                 data-field="merchantName"
                 bindinput="inputClaimForm" />
          <input class="form-input" 
                 placeholder="ä¼ä¸šåç§°ï¼ˆé€‰å¡«ï¼‰" 
                 value="{{claimForm.companyName}}"
                 data-field="companyName"
                 bindinput="inputClaimForm" />
          <input class="form-input" 
                 placeholder="è¥ä¸šæ‰§ç…§å·ï¼ˆé€‰å¡«ï¼‰" 
                 value="{{claimForm.license}}"
                 data-field="license"
                 bindinput="inputClaimForm" />
        </view>
        
        <view class="form-tips">
          <text class="tip-text">â€¢ è¯·ç¡®ä¿ä¿¡æ¯çœŸå®æœ‰æ•ˆ</text>
          <text class="tip-text">â€¢ å“ç‰Œæ–¹å°†åœ¨3ä¸ªå·¥ä½œæ—¥å†…å®¡æ ¸</text>
          <text class="tip-text">â€¢ å®¡æ ¸é€šè¿‡åå°†è‡ªåŠ¨æ¿€æ´»ç»é”€å•†æƒé™</text>
        </view>
        
        <view class="form-actions">
          <button class="cancel-btn" bindtap="closeClaimForm">å–æ¶ˆ</button>
          <button class="submit-btn" bindtap="submitClaimForm">æäº¤ç”³è¯·</button>
        </view>
      </view>
    </view>
  </view>
</view>