<!--å•†æˆ·ç”³è¯·çŠ¶æ€é¡µé¢-->
<view class="container" wx:if="{{!loading}}">
  <!-- çŠ¶æ€å¤´éƒ¨ -->
  <view class="status-header">
    <view class="status-icon" style="color: {{statusConfig[merchant.status].color}}">
      {{statusConfig[merchant.status].icon}}
    </view>
    <view class="status-title" style="color: {{statusConfig[merchant.status].color}}">
      {{statusConfig[merchant.status].title}}
    </view>
    <view class="status-description">
      {{statusConfig[merchant.status].description}}
    </view>
  </view>

  <!-- ç”³è¯·ä¿¡æ¯å¡ç‰‡ -->
  <view class="info-card">
    <view class="card-header">
      <view class="card-title">ç”³è¯·ä¿¡æ¯</view>
      <view class="apply-id" bindtap="copyMerchantId">
        ç¼–å·ï¼š{{merchantId}}
        <text class="copy-icon">ğŸ“‹</text>
      </view>
    </view>

    <view class="info-section">
      <view class="info-item">
        <view class="info-label">å•†æˆ·åç§°</view>
        <view class="info-value">{{merchant.name}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">ç»è¥ç±»åˆ«</view>
        <view class="info-value">{{merchant.category}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">è”ç³»äºº</view>
        <view class="info-value">{{merchant.contact}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">è”ç³»ç”µè¯</view>
        <view class="info-value">{{merchant.phone}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">æ‰€åœ¨åœ°åŒº</view>
        <view class="info-value">{{merchant.province}} {{merchant.city}}</view>
      </view>
    </view>
  </view>

  <!-- æ—¶é—´è½´ -->
  <view class="timeline-card">
    <view class="card-title">ç”³è¯·è¿›åº¦</view>
    
    <view class="timeline">
      <view class="timeline-item active">
        <view class="timeline-dot"></view>
        <view class="timeline-content">
          <view class="timeline-title">æäº¤ç”³è¯·</view>
          <view class="timeline-time">{{merchant.createTime}}</view>
          <view class="timeline-desc">æ‚¨çš„ç”³è¯·å·²æˆåŠŸæäº¤</view>
        </view>
      </view>

      <view class="timeline-item {{merchant.status !== 'pending' ? 'active' : ''}}">
        <view class="timeline-dot"></view>
        <view class="timeline-content">
          <view class="timeline-title">å®¡æ ¸å¤„ç†</view>
          <view class="timeline-time" wx:if="{{merchant.status !== 'pending'}}">
            {{merchant.approveTime}}
          </view>
          <view class="timeline-desc">
            <text wx:if="{{merchant.status === 'pending'}}">å®¡æ ¸ä¸­ï¼Œé¢„è®¡3ä¸ªå·¥ä½œæ—¥å®Œæˆ</text>
            <text wx:if="{{merchant.status === 'approved'}}">å®¡æ ¸é€šè¿‡ï¼Œæ¬¢è¿å…¥é©»ï¼</text>
            <text wx:if="{{merchant.status === 'rejected'}}">å®¡æ ¸æœªé€šè¿‡</text>
          </view>
        </view>
      </view>

      <view class="timeline-item {{merchant.status === 'approved' ? 'active' : ''}}" 
            wx:if="{{merchant.status === 'approved'}}">
        <view class="timeline-dot"></view>
        <view class="timeline-content">
          <view class="timeline-title">å¼€é€šæœåŠ¡</view>
          <view class="timeline-time">{{merchant.approveTime}}</view>
          <view class="timeline-desc">å•†æˆ·æœåŠ¡å·²å¼€é€šï¼Œå¯ä»¥æ­£å¸¸ç»è¥</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å®¡æ ¸æ„è§ -->
  <view class="feedback-card" wx:if="{{merchant.approveReason && merchant.status !== 'pending'}}">
    <view class="card-title">
      <text wx:if="{{merchant.status === 'approved'}}">é€šè¿‡è¯´æ˜</text>
      <text wx:if="{{merchant.status === 'rejected'}}">å®¡æ ¸æ„è§</text>
    </view>
    <view class="feedback-content {{merchant.status === 'rejected' ? 'rejected' : 'approved'}}">
      {{merchant.approveReason}}
    </view>
  </view>

  <!-- ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ -->
  <view class="images-card" wx:if="{{merchant.images}}">
    <view class="card-title">ä¸Šä¼ å›¾ç‰‡</view>
    
    <view class="image-section" wx:if="{{merchant.images.logo}}">
      <view class="image-label">å•†æˆ·Logo</view>
      <view class="image-preview">
        <image class="preview-image logo" 
               src="{{merchant.images.logo}}" 
               mode="aspectFill"
               data-type="logo"
               bindtap="previewImages"/>
      </view>
    </view>

    <view class="image-section" wx:if="{{merchant.images.storefront && merchant.images.storefront.length > 0}}">
      <view class="image-label">åº—é¢ç…§ç‰‡</view>
      <view class="image-preview">
        <image class="preview-image small" 
               wx:for="{{merchant.images.storefront}}" 
               wx:key="index"
               src="{{item}}" 
               mode="aspectFill"
               data-type="storefront"
               bindtap="previewImages"/>
      </view>
    </view>

    <view class="image-section" wx:if="{{merchant.images.license}}">
      <view class="image-label">è¥ä¸šæ‰§ç…§</view>
      <view class="image-preview">
        <image class="preview-image license" 
               src="{{merchant.images.license}}" 
               mode="aspectFill"
               data-type="license"
               bindtap="previewImages"/>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn btn-outline" bindtap="viewDetails">
      æŸ¥çœ‹è¯¦æƒ…
    </button>
    
    <button class="btn btn-outline" bindtap="contactService">
      è”ç³»å®¢æœ
    </button>
    
    <button class="btn btn-primary" 
            wx:if="{{merchant.status === 'rejected'}}"
            bindtap="reapply">
      é‡æ–°ç”³è¯·
    </button>
    
    <button class="btn btn-success" 
            wx:if="{{merchant.status === 'approved'}}"
            bindtap="goToMerchant">
      æŸ¥çœ‹æˆ‘çš„åº—é“º
    </button>
  </view>

  <!-- æ¸©é¦¨æç¤º -->
  <view class="tips-card">
    <view class="tips-title">æ¸©é¦¨æç¤º</view>
    <view class="tips-content">
      <view class="tip-item" wx:if="{{merchant.status === 'pending'}}">
        â€¢ å®¡æ ¸é€šå¸¸åœ¨3ä¸ªå·¥ä½œæ—¥å†…å®Œæˆ
      </view>
      <view class="tip-item" wx:if="{{merchant.status === 'pending'}}">
        â€¢ è¯·ä¿æŒæ‰‹æœºç•…é€šï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç”µè¯è”ç³»
      </view>
      <view class="tip-item">
        â€¢ å¦‚æœ‰ç–‘é—®è¯·è”ç³»å®¢æœï¼š400-888-8888
      </view>
      <view class="tip-item" wx:if="{{merchant.status === 'approved'}}">
        â€¢ é€šè¿‡å®¡æ ¸åå³å¯å¼€å§‹åœ¨å¹³å°ç»è¥
      </view>
      <view class="tip-item" wx:if="{{merchant.status === 'rejected'}}">
        â€¢ å¯æ ¹æ®å®¡æ ¸æ„è§ä¿®æ”¹åé‡æ–°ç”³è¯·
      </view>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:if="{{loading}}">
  <view class="loading-content">
    <view class="loading-icon">â³</view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
</view> 