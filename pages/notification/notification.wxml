<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view class="notification-container" wx:else>
    <!-- å¤´éƒ¨ç»Ÿè®¡å’Œæ“ä½œ -->
    <view class="notification-header">
      <view class="header-stats">
        <text class="stats-text">å…±{{stats.total}}æ¡æ¶ˆæ¯</text>
        <text class="unread-count" wx:if="{{stats.unread > 0}}">{{stats.unread}}æ¡æœªè¯»</text>
      </view>
      <view class="header-actions">
        <text class="action-text" bindtap="markAllRead" wx:if="{{stats.unread > 0}}">å…¨éƒ¨å·²è¯»</text>
        <text class="action-text" bindtap="showNotificationSettings">è®¾ç½®</text>
        <text class="action-text" bindtap="clearAll">æ¸…ç©º</text>
      </view>
    </view>

    <!-- ç­›é€‰æ  -->
    <view class="filter-bar">
      <view class="filter-item {{filterType === 'all' ? 'active' : ''}}" 
            bindtap="onFilterChange" 
            data-type="all">
        <text class="filter-text">å…¨éƒ¨</text>
        <text class="filter-count">{{stats.total}}</text>
      </view>
      <view class="filter-item {{filterType === 'unread' ? 'active' : ''}}" 
            bindtap="onFilterChange" 
            data-type="unread">
        <text class="filter-text">æœªè¯»</text>
        <text class="filter-count">{{stats.unread}}</text>
      </view>
      <view class="filter-item {{filterType === 'read' ? 'active' : ''}}" 
            bindtap="onFilterChange" 
            data-type="read">
        <text class="filter-text">å·²è¯»</text>
        <text class="filter-count">{{stats.read}}</text>
      </view>
    </view>

    <!-- é€šçŸ¥åˆ—è¡¨ -->
    <view class="notification-list">
      <view class="notification-item {{item.read ? 'read' : ''}}" 
            wx:for="{{notificationList}}" 
            wx:key="id"
            bindtap="readNotification"
            data-id="{{item.id}}">
        <view class="notification-icon">
          <view class="icon-bg {{item.type}}">{{item.icon}}</view>
          <view class="unread-dot" wx:if="{{!item.read}}"></view>
        </view>
        <view class="notification-content">
          <view class="notification-title">{{item.title}}</view>
          <view class="notification-desc">{{item.content}}</view>
          <view class="notification-time">{{item.timeText}}</view>
        </view>
        <view class="notification-actions">
          <view class="delete-btn" bindtap="deleteNotification" data-id="{{item.id}}">
            <text class="delete-icon">ğŸ—‘ï¸</text>
          </view>
          <view class="notification-arrow">></view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{notificationList.length === 0 && !loading}}">
      <view class="empty-icon">ğŸ“­</view>
      <text class="empty-text">
        {{filterType === 'all' ? 'æš‚æ— æ¶ˆæ¯é€šçŸ¥' : 
          filterType === 'unread' ? 'æ²¡æœ‰æœªè¯»æ¶ˆæ¯' : 'æ²¡æœ‰å·²è¯»æ¶ˆæ¯'}}
      </text>
      <view class="empty-actions" wx:if="{{filterType === 'all'}}">
        <button class="simulate-btn" bindtap="simulateNotifications">æ¨¡æ‹Ÿé€šçŸ¥</button>
      </view>
    </view>
  </view>

  <!-- é€šçŸ¥è®¾ç½®é¢æ¿ -->
  <view class="settings-mask" wx:if="{{showSettings}}" bindtap="hideNotificationSettings"></view>
  <view class="settings-panel" wx:if="{{showSettings}}">
    <view class="settings-header">
      <text class="settings-title">é€šçŸ¥è®¾ç½®</text>
      <view class="close-btn" bindtap="hideNotificationSettings">âœ•</view>
    </view>
    
    <view class="settings-content">
      <view class="setting-group">
        <text class="group-title">åŸºæœ¬è®¾ç½®</text>
        <view class="setting-item">
          <text class="setting-label">å¯ç”¨é€šçŸ¥</text>
          <switch checked bindchange="onSettingChange" data-setting="enabled" />
        </view>
        <view class="setting-item">
          <text class="setting-label">éœ‡åŠ¨æé†’</text>
          <switch checked bindchange="onSettingChange" data-setting="vibrate" />
        </view>
        <view class="setting-item">
          <text class="setting-label">å£°éŸ³æé†’</text>
          <switch checked bindchange="onSettingChange" data-setting="sound" />
        </view>
      </view>
      
      <view class="setting-group">
        <text class="group-title">é€šçŸ¥ç±»å‹</text>
        <view class="setting-item">
          <text class="setting-label">ğŸ”” ç³»ç»Ÿé€šçŸ¥</text>
          <switch checked bindchange="onSettingChange" data-setting="types.system" />
        </view>
        <view class="setting-item">
          <text class="setting-label">ğŸ’° ä»·æ ¼æé†’</text>
          <switch checked bindchange="onSettingChange" data-setting="types.price" />
        </view>
        <view class="setting-item">
          <text class="setting-label">ğŸ“¦ æ–°è´§é€šçŸ¥</text>
          <switch checked bindchange="onSettingChange" data-setting="types.goods" />
        </view>
        <view class="setting-item">
          <text class="setting-label">ğŸ‰ æ´»åŠ¨é€šçŸ¥</text>
          <switch checked bindchange="onSettingChange" data-setting="types.activity" />
        </view>
        <view class="setting-item">
          <text class="setting-label">ğŸšš è®¢å•é€šçŸ¥</text>
          <switch checked bindchange="onSettingChange" data-setting="types.order" />
        </view>
        <view class="setting-item">
          <text class="setting-label">ğŸ’¬ æ¶ˆæ¯é€šçŸ¥</text>
          <switch checked bindchange="onSettingChange" data-setting="types.message" />
        </view>
      </view>
    </view>
  </view>
</view> 