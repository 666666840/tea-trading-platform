<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-left">
      <button class="back-btn" bindtap="goBack">
        <text class="back-icon">â†</text>
      </button>
      <text class="header-title">å“ç‰Œå…¥é©»</text>
    </view>
    <view class="header-right">
      <text class="step-info">æ­¥éª¤ {{currentStep}}/{{totalSteps}}</text>
    </view>
  </view>

  <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
  <view class="step-indicator">
    <view class="step-list">
      <view class="step-item {{index < currentStep ? 'completed' : index === currentStep - 1 ? 'active' : ''}}" 
            wx:for="{{stepTitles}}" 
            wx:key="*this"
            wx:for-item="title"
            wx:for-index="index">
        <view class="step-number">{{index + 1}}</view>
        <text class="step-title">{{title}}</text>
      </view>
    </view>
  </view>

  <!-- æ­¥éª¤1ï¼šé€‰æ‹©å¥—é¤ -->
  <view class="step-content" wx:if="{{currentStep === 1}}">
    <view class="step-header">
      <text class="step-title">é€‰æ‹©å…¥é©»å¥—é¤</text>
      <text class="step-desc">é€‰æ‹©é€‚åˆæ‚¨å“ç‰Œçš„å…¥é©»å¥—é¤ï¼Œäº«å—ç›¸åº”çš„æƒç›Šå’ŒæœåŠ¡</text>
    </view>

    <view class="package-list">
      <view class="package-item {{selectedPackage === package.id ? 'selected' : ''}} {{package.popular ? 'popular' : ''}}" 
            wx:for="{{joinPackages}}" 
            wx:key="id"
            wx:for-item="package"
            bindtap="selectPackage"
            data-id="{{package.id}}">
        
        <!-- çƒ­é—¨æ ‡ç­¾ -->
        <view class="popular-badge" wx:if="{{package.popular}}">
          <text class="badge-text">æ¨è</text>
        </view>
        
        <!-- å¥—é¤å¤´éƒ¨ -->
        <view class="package-header">
          <text class="package-name">{{package.name}}</text>
          <view class="package-price">
            <text class="price-symbol">Â¥</text>
            <text class="price-value">{{package.price}}</text>
            <text class="price-unit">/å¹´</text>
          </view>
          <text class="original-price">åŸä»· Â¥{{package.originalPrice}}</text>
        </view>
        
        <!-- å¥—é¤æƒç›Š -->
        <view class="package-features">
          <view class="feature-item" 
                wx:for="{{package.features}}" 
                wx:key="*this"
                wx:for-item="feature">
            <text class="feature-icon">âœ“</text>
            <text class="feature-text">{{feature}}</text>
          </view>
        </view>
        
        <!-- é€‰æ‹©çŠ¶æ€ -->
        <view class="select-status">
          <text class="status-icon">{{selectedPackage === package.id ? 'âœ“' : 'â—‹'}}</text>
        </view>
      </view>
    </view>

    <!-- ç‰¹æƒæ”¿ç­– -->
    <view class="privilege-section">
      <view class="privilege-header">
        <text class="privilege-title">ğŸ–ï¸ ç‰¹æƒæ”¿ç­–</text>
      </view>
      <view class="privilege-content">
        <view class="privilege-item">
          <text class="privilege-label">çœçº§ä»¥ä¸Šå†œä¸šé¾™å¤´ä¼ä¸š</text>
          <text class="privilege-desc">å…å¹´è´¹ + "å›½å“è®¤è¯"å‹‹ç« </text>
        </view>
        <view class="privilege-item">
          <text class="privilege-label">ä¸­åè€å­—å·</text>
          <text class="privilege-desc">å…å¹´è´¹ + é¦–é¡µè½®æ’­ä½å±•ç¤º</text>
        </view>
        <view class="privilege-item">
          <text class="privilege-label">åœ°ç†æ ‡å¿—äº§å“</text>
          <text class="privilege-desc">äº«å—é«˜çº§å…¥é©»æƒç›Š</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ­¥éª¤2ï¼šåŸºæœ¬ä¿¡æ¯ -->
  <view class="step-content" wx:if="{{currentStep === 2}}">
    <view class="step-header">
      <text class="step-title">å“ç‰ŒåŸºæœ¬ä¿¡æ¯</text>
      <text class="step-desc">è¯·å¡«å†™å“ç‰Œçš„åŸºæœ¬ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å°†ç”¨äºå“ç‰Œå±•ç¤º</text>
    </view>

    <view class="form-section">
      <!-- å“ç‰ŒLogo -->
      <view class="form-item">
        <text class="form-label">å“ç‰ŒLogo</text>
        <view class="logo-upload" bindtap="uploadBrandLogo">
          <image wx:if="{{formData.brandLogo}}" 
                 class="logo-preview" 
                 src="{{formData.brandLogo}}" 
                 mode="aspectFit"></image>
          <view wx:else class="logo-placeholder">
            <text class="upload-icon">+</text>
            <text class="upload-text">ä¸Šä¼ Logo</text>
          </view>
        </view>
      </view>

      <!-- å“ç‰Œåç§° -->
      <view class="form-item">
        <text class="form-label">å“ç‰Œåç§° *</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥å“ç‰Œåç§°"
               value="{{formData.brandName}}"
               bindinput="inputFormData"
               data-field="brandName" />
        <text class="error-text" wx:if="{{formErrors.brandName}}">{{formErrors.brandName}}</text>
      </view>

      <!-- å“ç‰Œå£å· -->
      <view class="form-item">
        <text class="form-label">å“ç‰Œå£å· *</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥å“ç‰Œå£å·"
               value="{{formData.brandSlogan}}"
               bindinput="inputFormData"
               data-field="brandSlogan" />
        <text class="error-text" wx:if="{{formErrors.brandSlogan}}">{{formErrors.brandSlogan}}</text>
      </view>

      <!-- åˆ›ç«‹å¹´ä»½ -->
      <view class="form-item">
        <text class="form-label">åˆ›ç«‹å¹´ä»½ *</text>
        <input class="form-input" 
               type="number"
               placeholder="è¯·è¾“å…¥åˆ›ç«‹å¹´ä»½"
               value="{{formData.foundedYear}}"
               bindinput="inputFormData"
               data-field="foundedYear" />
        <text class="error-text" wx:if="{{formErrors.foundedYear}}">{{formErrors.foundedYear}}</text>
      </view>

      <!-- æ€»éƒ¨åœ°å€ -->
      <view class="form-item">
        <text class="form-label">æ€»éƒ¨åœ°å€ *</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥æ€»éƒ¨åœ°å€"
               value="{{formData.headquarters}}"
               bindinput="inputFormData"
               data-field="headquarters" />
        <text class="error-text" wx:if="{{formErrors.headquarters}}">{{formErrors.headquarters}}</text>
      </view>

      <!-- æ ¸å¿ƒäº§åŒº -->
      <view class="form-item">
        <text class="form-label">æ ¸å¿ƒäº§åŒº *</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥æ ¸å¿ƒäº§åŒº"
               value="{{formData.coreRegion}}"
               bindinput="inputFormData"
               data-field="coreRegion" />
        <text class="error-text" wx:if="{{formErrors.coreRegion}}">{{formErrors.coreRegion}}</text>
      </view>

      <!-- å¹´äº§é‡ -->
      <view class="form-item">
        <text class="form-label">å¹´äº§é‡</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥å¹´äº§é‡ï¼ˆå¦‚ï¼š5000å¨ï¼‰"
               value="{{formData.annualOutput}}"
               bindinput="inputFormData"
               data-field="annualOutput" />
      </view>

      <!-- è¦†ç›–å¸‚åœº -->
      <view class="form-item">
        <text class="form-label">è¦†ç›–å¸‚åœº</text>
        <input class="form-input" 
               type="number"
               placeholder="è¯·è¾“å…¥è¦†ç›–å¸‚åœºæ•°é‡"
               value="{{formData.marketCoverage}}"
               bindinput="inputFormData"
               data-field="marketCoverage" />
      </view>

      <!-- è”ç³»äººä¿¡æ¯ -->
      <view class="form-item">
        <text class="form-label">è”ç³»äººå§“å *</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥è”ç³»äººå§“å"
               value="{{formData.contactName}}"
               bindinput="inputFormData"
               data-field="contactName" />
        <text class="error-text" wx:if="{{formErrors.contactName}}">{{formErrors.contactName}}</text>
      </view>

      <view class="form-item">
        <text class="form-label">è”ç³»ç”µè¯ *</text>
        <input class="form-input" 
               type="number"
               placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯"
               value="{{formData.contactPhone}}"
               bindinput="inputFormData"
               data-field="contactPhone" />
        <text class="error-text" wx:if="{{formErrors.contactPhone}}">{{formErrors.contactPhone}}</text>
      </view>

      <view class="form-item">
        <text class="form-label">å¾®ä¿¡å·</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥å¾®ä¿¡å·"
               value="{{formData.contactWechat}}"
               bindinput="inputFormData"
               data-field="contactWechat" />
      </view>

      <view class="form-item">
        <text class="form-label">é‚®ç®±</text>
        <input class="form-input" 
               type="text"
               placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€"
               value="{{formData.contactEmail}}"
               bindinput="inputFormData"
               data-field="contactEmail" />
      </view>

      <!-- å“ç‰Œä»‹ç» -->
      <view class="form-item">
        <text class="form-label">å“ç‰Œä»‹ç»</text>
        <textarea class="form-textarea" 
                  placeholder="è¯·æè¿°å“ç‰Œå†å²ã€ç‰¹è‰²ã€ç†å¿µç­‰ï¼ˆé€‰å¡«ï¼‰"
                  value="{{formData.brandDescription}}"
                  bindinput="inputFormData"
                  data-field="brandDescription"
                  maxlength="500"></textarea>
        <text class="char-count">{{formData.brandDescription.length}}/500</text>
      </view>

      <!-- å“ç‰Œå›¾ç‰‡ -->
      <view class="form-item">
        <text class="form-label">å“ç‰Œå›¾ç‰‡</text>
        <text class="form-tip">æœ€å¤š9å¼ ï¼Œå»ºè®®ä¸Šä¼ å“ç‰Œç›¸å…³çš„é«˜è´¨é‡å›¾ç‰‡</text>
        <view class="image-upload">
          <view class="image-list">
            <view class="image-item" 
                  wx:for="{{formData.brandImages}}" 
                  wx:key="*this"
                  wx:for-item="image"
                  wx:for-index="index">
              <image class="uploaded-image" 
                     src="{{image}}" 
                     mode="aspectFill"
                     bindtap="previewImage" 
                     data-url="{{image}}"
                     data-urls="{{formData.brandImages}}"></image>
              <view class="delete-btn" 
                    bindtap="deleteBrandImage" 
                    data-index="{{index}}">
                <text class="delete-icon">Ã—</text>
              </view>
            </view>
            <view class="upload-btn" 
                  wx:if="{{formData.brandImages.length < 9}}"
                  bindtap="uploadBrandImages">
              <text class="upload-icon">+</text>
              <text class="upload-text">ä¸Šä¼ å›¾ç‰‡</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ­¥éª¤3ï¼šä¼ä¸šèµ„è´¨ -->
  <view class="step-content" wx:if="{{currentStep === 3}}">
    <view class="step-header">
      <text class="step-title">ä¼ä¸šèµ„è´¨è®¤è¯</text>
      <text class="step-desc">è¯·æä¾›ä¼ä¸šç›¸å…³èµ„è´¨è¯æ˜ï¼Œç”¨äºå“ç‰Œè®¤è¯</text>
    </view>

    <view class="form-section">
      <!-- ä¼ä¸šåç§° -->
      <view class="form-item">
        <text class="form-label">ä¼ä¸šåç§° *</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥ä¼ä¸šåç§°"
               value="{{formData.companyName}}"
               bindinput="inputFormData"
               data-field="companyName" />
        <text class="error-text" wx:if="{{formErrors.companyName}}">{{formErrors.companyName}}</text>
      </view>

      <!-- è¥ä¸šæ‰§ç…§ -->
      <view class="form-item">
        <text class="form-label">è¥ä¸šæ‰§ç…§ *</text>
        <view class="certificate-upload" bindtap="uploadBusinessLicense">
          <image wx:if="{{formData.businessLicense}}" 
                 class="certificate-preview" 
                 src="{{formData.businessLicense}}" 
                 mode="aspectFit"
                 bindtap="previewImage"
                 data-url="{{formData.businessLicense}}"></image>
          <view wx:else class="certificate-placeholder">
            <text class="upload-icon">ğŸ“„</text>
            <text class="upload-text">ä¸Šä¼ è¥ä¸šæ‰§ç…§</text>
          </view>
        </view>
        <text class="error-text" wx:if="{{formErrors.businessLicense}}">{{formErrors.businessLicense}}</text>
      </view>

      <!-- å•†æ ‡æ³¨å†Œè¯ -->
      <view class="form-item">
        <text class="form-label">å•†æ ‡æ³¨å†Œè¯ *</text>
        <view class="certificate-upload" bindtap="uploadTrademarkCertificate">
          <image wx:if="{{formData.trademarkCertificate}}" 
                 class="certificate-preview" 
                 src="{{formData.trademarkCertificate}}" 
                 mode="aspectFit"
                 bindtap="previewImage"
                 data-url="{{formData.trademarkCertificate}}"></image>
          <view wx:else class="certificate-placeholder">
            <text class="upload-icon">ğŸ·ï¸</text>
            <text class="upload-text">ä¸Šä¼ å•†æ ‡æ³¨å†Œè¯</text>
          </view>
        </view>
        <text class="error-text" wx:if="{{formErrors.trademarkCertificate}}">{{formErrors.trademarkCertificate}}</text>
      </view>

      <!-- ä¸»è¥å“ç±» -->
      <view class="form-item">
        <text class="form-label">ä¸»è¥å“ç±» *</text>
        <view class="category-grid">
          <view class="category-item {{formData.mainCategories.indexOf(category) > -1 ? 'selected' : ''}}" 
                wx:for="{{mainCategories}}" 
                wx:key="*this"
                wx:for-item="category"
                bindtap="selectMainCategory"
                data-category="{{category}}">
            <text class="category-name">{{category}}</text>
          </view>
        </view>
        <text class="error-text" wx:if="{{formErrors.mainCategories}}">{{formErrors.mainCategories}}</text>
      </view>

      <!-- äº§å“çº¿ -->
      <view class="form-item">
        <text class="form-label">äº§å“çº¿</text>
        <input class="form-input" 
               placeholder="è¯·è¾“å…¥ä¸»è¦äº§å“çº¿ï¼ˆå¦‚ï¼šè¥¿æ¹–é¾™äº•ã€ç¢§èºæ˜¥ç­‰ï¼‰"
               value="{{formData.productLinesText}}"
               bindinput="inputFormData"
               data-field="productLines" />
      </view>

      <!-- è®¤è¯ç±»å‹ -->
      <view class="form-item">
        <text class="form-label">è®¤è¯ç±»å‹</text>
        <view class="certification-grid">
          <view class="certification-item {{formData.certifications.indexOf(certification) > -1 ? 'selected' : ''}}" 
                wx:for="{{certificationOptions}}" 
                wx:key="*this"
                wx:for-item="certification"
                bindtap="selectCertification"
                data-certification="{{certification}}">
            <text class="certification-name">{{certification}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ­¥éª¤4ï¼šç¡®è®¤æäº¤ -->
  <view class="step-content" wx:if="{{currentStep === 4}}">
    <view class="step-header">
      <text class="step-title">ç¡®è®¤æäº¤</text>
      <text class="step-desc">è¯·ç¡®è®¤æ‰€æœ‰ä¿¡æ¯æ— è¯¯åæäº¤ç”³è¯·</text>
    </view>

    <view class="confirm-section">
      <!-- å¥—é¤ä¿¡æ¯ -->
      <view class="confirm-group">
        <text class="group-title">é€‰æ‹©çš„å¥—é¤</text>
        <view class="package-summary">
          <text class="package-name">{{selectedPackageInfo.name}}</text>
          <text class="package-price">Â¥{{selectedPackageInfo.price}}/å¹´</text>
        </view>
      </view>

      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <view class="confirm-group">
        <text class="group-title">åŸºæœ¬ä¿¡æ¯</text>
        <view class="info-list">
          <view class="info-item">
            <text class="info-label">å“ç‰Œåç§°</text>
            <text class="info-value">{{formData.brandName}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">å“ç‰Œå£å·</text>
            <text class="info-value">{{formData.brandSlogan}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">åˆ›ç«‹å¹´ä»½</text>
            <text class="info-value">{{formData.foundedYear}}å¹´</text>
          </view>
          <view class="info-item">
            <text class="info-label">æ€»éƒ¨åœ°å€</text>
            <text class="info-value">{{formData.headquarters}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">æ ¸å¿ƒäº§åŒº</text>
            <text class="info-value">{{formData.coreRegion}}</text>
          </view>
        </view>
      </view>

      <!-- è”ç³»ä¿¡æ¯ -->
      <view class="confirm-group">
        <text class="group-title">è”ç³»ä¿¡æ¯</text>
        <view class="info-list">
          <view class="info-item">
            <text class="info-label">è”ç³»äºº</text>
            <text class="info-value">{{formData.contactName}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">è”ç³»ç”µè¯</text>
            <text class="info-value">{{formData.contactPhone}}</text>
          </view>
          <view class="info-item" wx:if="{{formData.contactWechat}}">
            <text class="info-label">å¾®ä¿¡å·</text>
            <text class="info-value">{{formData.contactWechat}}</text>
          </view>
        </view>
      </view>

      <!-- ä¼ä¸šä¿¡æ¯ -->
      <view class="confirm-group">
        <text class="group-title">ä¼ä¸šä¿¡æ¯</text>
        <view class="info-list">
          <view class="info-item">
            <text class="info-label">ä¼ä¸šåç§°</text>
            <text class="info-value">{{formData.companyName}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">ä¸»è¥å“ç±»</text>
            <text class="info-value">{{formData.mainCategoriesText}}</text>
          </view>
        </view>
      </view>

      <!-- æäº¤è¯´æ˜ -->
      <view class="submit-notice">
        <text class="notice-title">ğŸ“‹ æäº¤è¯´æ˜</text>
        <view class="notice-content">
          <text class="notice-item">â€¢ ç”³è¯·æäº¤åï¼Œå¹³å°å°†åœ¨48å°æ—¶å†…è¿›è¡Œäººå·¥å®¡æ ¸</text>
          <text class="notice-item">â€¢ å®¡æ ¸é€šè¿‡åï¼Œå®¢æœå°†è”ç³»æ‚¨å®Œæˆè´¹ç”¨ç¼´çº³</text>
          <text class="notice-item">â€¢ ç¼´è´¹æˆåŠŸåï¼Œå“ç‰Œå°†æ­£å¼å…¥é©»å¹³å°</text>
          <text class="notice-item">â€¢ å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»å®¢æœï¼š400-123-4567</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="prev-btn" 
            wx:if="{{currentStep > 1}}"
            bindtap="prevStep">
      ä¸Šä¸€æ­¥
    </button>
    <button class="next-btn" 
            wx:if="{{currentStep < totalSteps}}"
            bindtap="nextStep">
      ä¸‹ä¸€æ­¥
    </button>
    <button class="submit-btn {{submitting ? 'submitting' : ''}}" 
            wx:if="{{currentStep === totalSteps}}"
            bindtap="submitApplication"
            disabled="{{submitting}}">
      <text wx:if="{{!submitting}}">æäº¤ç”³è¯·</text>
      <text wx:else>æäº¤ä¸­...</text>
    </button>
  </view>

  <!-- æäº¤çŠ¶æ€é®ç½© -->
  <view class="loading-mask" wx:if="{{submitting}}">
    <view class="loading-content">
      <view class="loading-icon">â³</view>
      <text class="loading-text">æ­£åœ¨æäº¤ç”³è¯·...</text>
    </view>
  </view>
</view> 