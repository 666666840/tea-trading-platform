# é«˜çº§æœç´¢å’Œç­›é€‰åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“– åŠŸèƒ½æ¦‚è¿°

é«˜çº§æœç´¢å’Œç­›é€‰åŠŸèƒ½ä¸ºèŒ¶å¶ä¸€ç‚¹é€šå¹³å°æä¾›äº†å¼ºå¤§çš„æ•°æ®æ£€ç´¢èƒ½åŠ›ï¼Œæ”¯æŒå¤šæ¡ä»¶ç»„åˆæœç´¢ã€ä»·æ ¼èŒƒå›´ç­›é€‰ã€æ—¶é—´èŒƒå›´ç­›é€‰ç­‰å¤šç§é«˜çº§åŠŸèƒ½ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### âœ… å·²å®ç°åŠŸèƒ½
- **å¤šæ¡ä»¶ç»„åˆæœç´¢** - æ”¯æŒå…³é”®è¯ã€åˆ†ç±»ã€ç±»å‹ã€çœä»½ç­‰å¤šç»´åº¦ç­›é€‰
- **ä»·æ ¼èŒƒå›´ç­›é€‰** - æ”¯æŒç²¾ç¡®ä»·æ ¼å’Œä»·æ ¼åŒºé—´æœç´¢
- **æ—¶é—´èŒƒå›´ç­›é€‰** - æ”¯æŒåˆ›å»ºæ—¶é—´èŒƒå›´ç­›é€‰
- **æ™ºèƒ½åˆ†é¡µ** - æ”¯æŒåˆ†é¡µåŠ è½½å’Œç»“æœç»Ÿè®¡
- **ç­›é€‰é€‰é¡¹åŠ¨æ€è·å–** - æ ¹æ®æ•°æ®ç±»å‹åŠ¨æ€è·å–å¯ç”¨ç­›é€‰é€‰é¡¹
- **ç¦»çº¿é™çº§** - ç½‘ç»œå¼‚å¸¸æ—¶è‡ªåŠ¨ä½¿ç”¨æœ¬åœ°æ•°æ®
- **æ€§èƒ½ä¼˜åŒ–** - æ”¯æŒç¼“å­˜å’Œå¹¶å‘è¯·æ±‚ä¼˜åŒ–

### ğŸ¯ æ”¯æŒçš„æ•°æ®ç±»å‹
- **å¸‚åœºæ•°æ®** (`markets`) - èŒ¶å¶å¸‚åœºä¿¡æ¯
- **æ–°å“æ•°æ®** (`newarrivals`) - æ–°å“åˆ°è´§ä¿¡æ¯
- **ä¾›æ±‚æ•°æ®** (`supplies`) - ä¾›åº”å’Œéœ€æ±‚ä¿¡æ¯
- **æ¸…ä»“æ•°æ®** (`clearance`) - æ¸…ä»“ç‰¹ä»·ä¿¡æ¯
- **å†…å®¹æ•°æ®** (`content`) - æ–‡ç« å’Œèµ„è®¯å†…å®¹

## ğŸ”§ APIæ¥å£è¯´æ˜

### 1. é«˜çº§æœç´¢æ¥å£

#### å¸‚åœºé«˜çº§æœç´¢
```javascript
// åŸºç¡€ç”¨æ³•
const response = await API.advancedSearchMarkets({
  keyword: 'èŒ¶å¶å¸‚åœº',
  province: 'ç¦å»ºçœ',
  dateRange: '2024-01-01-2024-12-31'
})

// å®Œæ•´å‚æ•°
const response = await API.advancedSearchMarkets({
  keyword: 'èŒ¶å¶',           // å…³é”®è¯æœç´¢
  province: 'ç¦å»ºçœ',        // çœä»½ç­›é€‰
  dateRange: '2024-01-01-2024-12-31', // æ—¶é—´èŒƒå›´
  page: 1,                   // é¡µç 
  perPage: 20                // æ¯é¡µæ•°é‡
})
```

#### æ–°å“é«˜çº§æœç´¢
```javascript
const response = await API.advancedSearchNewarrivals({
  keyword: 'é¾™äº•èŒ¶',         // å…³é”®è¯æœç´¢
  category: 'ç»¿èŒ¶',          // åˆ†ç±»ç­›é€‰
  priceRange: '100-500',     // ä»·æ ¼èŒƒå›´
  dateRange: '2024-01-01-2024-12-31' // æ—¶é—´èŒƒå›´
})
```

#### ä¾›æ±‚é«˜çº§æœç´¢
```javascript
const response = await API.advancedSearchSupplies({
  keyword: 'é“è§‚éŸ³',         // å…³é”®è¯æœç´¢
  type: 'ä¾›åº”',              // ç±»å‹ç­›é€‰
  priceRange: '200-1000',    // ä»·æ ¼èŒƒå›´
  status: 'active'           // çŠ¶æ€ç­›é€‰
})
```

#### æ¸…ä»“é«˜çº§æœç´¢
```javascript
const response = await API.advancedSearchClearance({
  keyword: 'æ™®æ´±èŒ¶',         // å…³é”®è¯æœç´¢
  category: 'æ™®æ´±èŒ¶',        // åˆ†ç±»ç­›é€‰
  priceRange: '50-300'       // ä»·æ ¼èŒƒå›´
})
```

#### å†…å®¹é«˜çº§æœç´¢
```javascript
const response = await API.advancedSearchContent({
  keyword: 'èŒ¶è‰º',           // å…³é”®è¯æœç´¢
  type: 'art',               // å†…å®¹ç±»å‹
  tag: 'å†²æ³¡æŠ€å·§'            // æ ‡ç­¾ç­›é€‰
})
```

### 2. ç­›é€‰é€‰é¡¹è·å–æ¥å£

```javascript
// è·å–æ‰€æœ‰ç­›é€‰é€‰é¡¹
const response = await API.getFilterOptions('all')

// è·å–ç‰¹å®šç±»å‹çš„ç­›é€‰é€‰é¡¹
const response = await API.getFilterOptions('markets')
const response = await API.getFilterOptions('newarrivals')
const response = await API.getFilterOptions('supplies')
const response = await API.getFilterOptions('clearance')
const response = await API.getFilterOptions('content')
```

### 3. å‚æ•°æ„å»ºå·¥å…·

```javascript
// ä½¿ç”¨å‚æ•°æ„å»ºå·¥å…·
const filters = API.buildAdvancedFilters({
  keyword: 'é¾™äº•èŒ¶',
  category: 'ç»¿èŒ¶',
  priceRange: '100-500',
  dateRange: '2024-01-01-2024-12-31',
  province: 'æµ™æ±Ÿçœ',
  type: 'ä¾›åº”',
  tag: 'æ–°å“æ¨è',
  status: 'active',
  page: 1,
  perPage: 20
})

// ç„¶åä½¿ç”¨æ„å»ºçš„å‚æ•°è¿›è¡Œæœç´¢
const response = await API.advancedSearchNewarrivals(filters)
```

## ğŸ“‹ å‚æ•°æ ¼å¼è¯´æ˜

### å…³é”®è¯æœç´¢ (`keyword`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **è¯´æ˜**: æ”¯æŒæ¨¡ç³Šæœç´¢ï¼Œä¼šåœ¨æ ‡é¢˜ã€æè¿°ã€å†…å®¹ç­‰å­—æ®µä¸­æŸ¥æ‰¾
- **ç¤ºä¾‹**: `'é¾™äº•èŒ¶'`, `'èŒ¶å¶å¸‚åœº'`

### åˆ†ç±»ç­›é€‰ (`category`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **è¯´æ˜**: ç²¾ç¡®åŒ¹é…åˆ†ç±»åç§°
- **ç¤ºä¾‹**: `'ç»¿èŒ¶'`, `'çº¢èŒ¶'`, `'æ™®æ´±èŒ¶'`

### ç±»å‹ç­›é€‰ (`type`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **è¯´æ˜**: ç²¾ç¡®åŒ¹é…ç±»å‹åç§°
- **ç¤ºä¾‹**: `'ä¾›åº”'`, `'æ±‚è´­'`, `'recommend'`, `'news'`

### çœä»½ç­›é€‰ (`province`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **è¯´æ˜**: ç²¾ç¡®åŒ¹é…çœä»½åç§°
- **ç¤ºä¾‹**: `'ç¦å»ºçœ'`, `'æµ™æ±Ÿçœ'`, `'äº‘å—çœ'`

### ä»·æ ¼èŒƒå›´ç­›é€‰ (`priceRange`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **æ ¼å¼**: `'æœ€å°å€¼-æœ€å¤§å€¼'` æˆ– `'ç²¾ç¡®ä»·æ ¼'`
- **è¯´æ˜**: æ”¯æŒä»·æ ¼åŒºé—´å’Œç²¾ç¡®ä»·æ ¼æœç´¢
- **ç¤ºä¾‹**: 
  - `'100-500'` - ä»·æ ¼åœ¨100åˆ°500ä¹‹é—´
  - `'300'` - ä»·æ ¼ç­‰äº300
  - `'100-'` - ä»·æ ¼å¤§äºç­‰äº100
  - `'-500'` - ä»·æ ¼å°äºç­‰äº500

### æ—¶é—´èŒƒå›´ç­›é€‰ (`dateRange`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **æ ¼å¼**: `'å¼€å§‹æ—¥æœŸ-ç»“æŸæ—¥æœŸ'` æˆ– `'å…·ä½“æ—¥æœŸ'`
- **è¯´æ˜**: æ”¯æŒæ—¥æœŸåŒºé—´å’Œå…·ä½“æ—¥æœŸæœç´¢
- **ç¤ºä¾‹**:
  - `'2024-01-01-2024-12-31'` - 2024å¹´å…¨å¹´
  - `'2024-01-01'` - 2024å¹´1æœˆ1æ—¥
  - `'2024-01-01-'` - 2024å¹´1æœˆ1æ—¥ä¹‹å
  - `'-2024-12-31'` - 2024å¹´12æœˆ31æ—¥ä¹‹å‰

### æ ‡ç­¾ç­›é€‰ (`tag`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **è¯´æ˜**: ç²¾ç¡®åŒ¹é…æ ‡ç­¾åç§°
- **ç¤ºä¾‹**: `'æ–°å“æ¨è'`, `'å†²æ³¡æŠ€å·§'`, `'å¸‚åœºåˆ†æ'`

### çŠ¶æ€ç­›é€‰ (`status`)
- **ç±»å‹**: å­—ç¬¦ä¸²
- **è¯´æ˜**: ç²¾ç¡®åŒ¹é…çŠ¶æ€åç§°
- **ç¤ºä¾‹**: `'active'`, `'inactive'`, `'hot'`

### åˆ†é¡µå‚æ•°
- **page**: é¡µç ï¼Œä»1å¼€å§‹
- **perPage**: æ¯é¡µæ•°é‡ï¼Œæœ€å¤§100

## ğŸ¨ å‰ç«¯ç»„ä»¶ä½¿ç”¨

### 1. å¼•å…¥é«˜çº§æœç´¢ç»„ä»¶

```javascript
const AdvancedSearch = require('../../utils/advanced-search.js')

Page({
  data: {
    list: [],
    hasMore: true,
    currentFilters: {}
  },

  onLoad() {
    // åˆå§‹åŒ–é«˜çº§æœç´¢ç»„ä»¶
    this.advancedSearch = AdvancedSearch
    this.advancedSearch.init(this, 'markets') // æŒ‡å®šæ•°æ®ç±»å‹
  }
})
```

### 2. åœ¨é¡µé¢ä¸­ä½¿ç”¨

```html
<!-- æœç´¢è¡¨å• -->
<view class="search-form">
  <input 
    placeholder="æœç´¢å…³é”®è¯" 
    bindinput="onKeywordInput"
    data-filter="keyword"
  />
  
  <picker 
    mode="selector" 
    range="{{provinces}}" 
    bindchange="onProvinceChange"
    data-filter="province"
  >
    <view>é€‰æ‹©çœä»½</view>
  </picker>
  
  <input 
    placeholder="ä»·æ ¼èŒƒå›´ï¼Œå¦‚ï¼š100-500" 
    bindinput="onPriceRangeInput"
    data-filter="priceRange"
  />
  
  <picker 
    mode="date" 
    bindchange="onDateRangeChange"
    data-filter="dateRange"
  >
    <view>é€‰æ‹©æ—¥æœŸ</view>
  </picker>
  
  <button bindtap="onSearch">æœç´¢</button>
  <button bindtap="onReset">é‡ç½®</button>
</view>

<!-- æœç´¢ç»“æœ -->
<view class="search-results">
  <view wx:for="{{list}}" wx:key="id" class="result-item">
    <text>{{item.name || item.title}}</text>
  </view>
</view>
```

### 3. äº‹ä»¶å¤„ç†

```javascript
Page({
  // å…³é”®è¯è¾“å…¥
  onKeywordInput(e) {
    this.setData({
      'currentFilters.keyword': e.detail.value
    })
  },

  // çœä»½é€‰æ‹©
  onProvinceChange(e) {
    const provinces = this.data.provinces
    this.setData({
      'currentFilters.province': provinces[e.detail.value]
    })
  },

  // ä»·æ ¼èŒƒå›´è¾“å…¥
  onPriceRangeInput(e) {
    this.setData({
      'currentFilters.priceRange': e.detail.value
    })
  },

  // æ—¥æœŸèŒƒå›´é€‰æ‹©
  onDateRangeChange(e) {
    this.setData({
      'currentFilters.dateRange': e.detail.value
    })
  },

  // æ‰§è¡Œæœç´¢
  async onSearch() {
    try {
      wx.showLoading({ title: 'æœç´¢ä¸­...' })
      
      const filters = API.buildAdvancedFilters(this.data.currentFilters)
      const response = await API.advancedSearchMarkets(filters)
      
      if (response.status === 'success') {
        this.setData({
          list: response.data,
          hasMore: response.data.length > 0
        })
        
        wx.showToast({
          title: `æ‰¾åˆ° ${response.pagination.total} æ¡ç»“æœ`,
          icon: 'none'
        })
      }
    } catch (error) {
      wx.showToast({
        title: 'æœç´¢å¤±è´¥',
        icon: 'none'
      })
    } finally {
      wx.hideLoading()
    }
  },

  // é‡ç½®æœç´¢
  onReset() {
    this.setData({
      currentFilters: {}
    })
    this.onSearch()
  }
})
```

## ğŸ” æœç´¢ç¤ºä¾‹

### ç¤ºä¾‹1: æœç´¢ç¦å»ºçœçš„èŒ¶å¶å¸‚åœº
```javascript
const response = await API.advancedSearchMarkets({
  keyword: 'èŒ¶å¶',
  province: 'ç¦å»ºçœ'
})
```

### ç¤ºä¾‹2: æœç´¢100-500å…ƒçš„ç»¿èŒ¶æ–°å“
```javascript
const response = await API.advancedSearchNewarrivals({
  keyword: 'é¾™äº•',
  category: 'ç»¿èŒ¶',
  priceRange: '100-500'
})
```

### ç¤ºä¾‹3: æœç´¢2024å¹´çš„ä¾›åº”ä¿¡æ¯
```javascript
const response = await API.advancedSearchSupplies({
  type: 'ä¾›åº”',
  dateRange: '2024-01-01-2024-12-31',
  status: 'active'
})
```

### ç¤ºä¾‹4: æœç´¢èŒ¶è‰ºç›¸å…³æ–‡ç« 
```javascript
const response = await API.advancedSearchContent({
  keyword: 'èŒ¶è‰º',
  type: 'art',
  tag: 'å†²æ³¡æŠ€å·§'
})
```

### ç¤ºä¾‹5: å¤æ‚ç»„åˆæœç´¢
```javascript
const response = await API.advancedSearchNewarrivals({
  keyword: 'èŒ¶',
  category: 'ç»¿èŒ¶',
  priceRange: '50-1000',
  dateRange: '2024-01-01-2024-12-31',
  page: 1,
  perPage: 20
})
```

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. åˆç†ä½¿ç”¨ç­›é€‰æ¡ä»¶
- ä¼˜å…ˆä½¿ç”¨ç²¾ç¡®åŒ¹é…çš„ç­›é€‰æ¡ä»¶ï¼ˆå¦‚åˆ†ç±»ã€ç±»å‹ã€çœä»½ï¼‰
- å…³é”®è¯æœç´¢ä½œä¸ºè¡¥å……ï¼Œé¿å…è¿‡äºå®½æ³›çš„å…³é”®è¯
- åˆç†è®¾ç½®ä»·æ ¼å’Œæ—¶é—´èŒƒå›´ï¼Œé¿å…èŒƒå›´è¿‡å¤§

### 2. åˆ†é¡µåŠ è½½
- ä½¿ç”¨åˆ†é¡µå‚æ•°æ§åˆ¶æ¯æ¬¡åŠ è½½çš„æ•°æ®é‡
- å»ºè®®æ¯é¡µ20-50æ¡æ•°æ®
- å®ç°"åŠ è½½æ›´å¤š"åŠŸèƒ½è€Œä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®

### 3. ç¼“å­˜ç­–ç•¥
- å¯¹ç­›é€‰é€‰é¡¹è¿›è¡Œç¼“å­˜ï¼Œé¿å…é‡å¤è¯·æ±‚
- å¯¹æœç´¢ç»“æœè¿›è¡ŒçŸ­æœŸç¼“å­˜
- ä½¿ç”¨APIç®¡ç†å™¨çš„ç¼“å­˜åŠŸèƒ½

### 4. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- æœç´¢æ—¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
- æä¾›æœç´¢å»ºè®®å’Œè‡ªåŠ¨å®Œæˆ
- ä¿å­˜ç”¨æˆ·çš„æœç´¢å†å²
- æä¾›å¿«é€Ÿç­›é€‰æŒ‰é’®

## ğŸ› ï¸ é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

#### 1. å‚æ•°æ ¼å¼é”™è¯¯
```javascript
// é”™è¯¯çš„ä»·æ ¼èŒƒå›´æ ¼å¼
const response = await API.advancedSearchNewarrivals({
  priceRange: 'invalid-price' // é”™è¯¯æ ¼å¼
})

// æ­£ç¡®çš„ä»·æ ¼èŒƒå›´æ ¼å¼
const response = await API.advancedSearchNewarrivals({
  priceRange: '100-500' // æ­£ç¡®æ ¼å¼
})
```

#### 2. ç½‘ç»œè¿æ¥é”™è¯¯
```javascript
try {
  const response = await API.advancedSearchMarkets(filters)
  // å¤„ç†æˆåŠŸå“åº”
} catch (error) {
  if (error.message.includes('è¿æ¥å¤±è´¥')) {
    // ä½¿ç”¨ç¦»çº¿æ•°æ®æˆ–æ˜¾ç¤ºé”™è¯¯æç¤º
    wx.showToast({
      title: 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œä½¿ç”¨ç¦»çº¿æ•°æ®',
      icon: 'none'
    })
  }
}
```

#### 3. æœåŠ¡å™¨é”™è¯¯
```javascript
const response = await API.advancedSearchMarkets(filters)
if (response.status === 'error') {
  wx.showToast({
    title: response.message || 'æœç´¢å¤±è´¥',
    icon: 'none'
  })
}
```

## ğŸ“Š æµ‹è¯•å’Œè°ƒè¯•

### 1. ä½¿ç”¨æµ‹è¯•è„šæœ¬
```javascript
// è¿è¡Œæµ‹è¯•è„šæœ¬
const testScript = require('./æµ‹è¯•é«˜çº§æœç´¢åŠŸèƒ½.js')
testScript.runAllTests()
```

### 2. è°ƒè¯•æŠ€å·§
- ä½¿ç”¨ `console.log` è¾“å‡ºæœç´¢å‚æ•°å’Œç»“æœ
- æ£€æŸ¥ç½‘ç»œè¯·æ±‚çš„URLå’Œå‚æ•°
- éªŒè¯ç­›é€‰é€‰é¡¹æ˜¯å¦æ­£ç¡®åŠ è½½
- æµ‹è¯•è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸è¾“å…¥

### 3. æ€§èƒ½ç›‘æ§
- ç›‘æ§æœç´¢å“åº”æ—¶é—´
- æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
- è§‚å¯Ÿç½‘ç»œè¯·æ±‚é¢‘ç‡
- åˆ†æç”¨æˆ·æœç´¢è¡Œä¸º

## ğŸ”® æœªæ¥æ‰©å±•

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
- **åœ°ç†ä½ç½®æœç´¢** - åŸºäºç”¨æˆ·ä½ç½®çš„é™„è¿‘æœç´¢
- **æ™ºèƒ½æ¨è** - åŸºäºç”¨æˆ·è¡Œä¸ºçš„æœç´¢å»ºè®®
- **è¯­éŸ³æœç´¢** - æ”¯æŒè¯­éŸ³è¾“å…¥æœç´¢
- **å›¾ç‰‡æœç´¢** - æ”¯æŒå›¾ç‰‡è¯†åˆ«æœç´¢
- **é«˜çº§æ’åº** - æ”¯æŒå¤šç§æ’åºæ–¹å¼
- **æœç´¢å†å²** - ä¿å­˜å’Œç®¡ç†æœç´¢å†å²
- **æ”¶è—æœç´¢** - ä¿å­˜å¸¸ç”¨æœç´¢æ¡ä»¶

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2025-07-17  
**ç»´æŠ¤è€…**: AI Assistant 