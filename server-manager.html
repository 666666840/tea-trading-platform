<!DOCTYPE html>
<html>
<head>
    <title>èŒ¶å¶APIæœåŠ¡å™¨ç®¡ç†</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Microsoft YaHei'; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .primary { background: #007bff; color: white; }
        .danger { background: #dc3545; color: white; }
        .success-btn { background: #28a745; color: white; }
        #log { background: #f8f9fa; padding: 15px; border-radius: 5px; white-space: pre-wrap; font-family: monospace; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸƒ èŒ¶å¶APIæœåŠ¡å™¨ç®¡ç†ä¸­å¿ƒ</h1>
        
        <div class="status info">
            <strong>æœåŠ¡å™¨ä¿¡æ¯ï¼š</strong><br>
            IP: 82.157.231.110<br>
            æœåŠ¡ç«¯å£: 3000<br>
            æœåŠ¡è·¯å¾„: /www/wwwroot/tea-api/
        </div>

        <div>
            <button class="primary" onclick="checkStatus()">ğŸ” æ£€æŸ¥æœåŠ¡çŠ¶æ€</button>
            <button class="success-btn" onclick="startService()">â–¶ï¸ å¯åŠ¨æœåŠ¡</button>
            <button class="danger" onclick="stopService()">â¹ï¸ åœæ­¢æœåŠ¡</button>
            <button class="primary" onclick="testAPI()">ğŸ§ª æµ‹è¯•API</button>
        </div>

        <div id="status-display"></div>
        <div id="log"></div>

        <div class="status info">
            <strong>APIæ¥å£åœ°å€ï¼š</strong><br>
            â€¢ å¥åº·æ£€æŸ¥: <a href="http://82.157.231.110:3000/health" target="_blank">http://82.157.231.110:3000/health</a><br>
            â€¢ æ¨èå†…å®¹: <a href="http://82.157.231.110:3000/api/content?type=recommend" target="_blank">http://82.157.231.110:3000/api/content?type=recommend</a><br>
            â€¢ èŒ¶å¶æ–°é—»: <a href="http://82.157.231.110:3000/api/content?type=news" target="_blank">http://82.157.231.110:3000/api/content?type=news</a><br>
            â€¢ èŒ¶è‰ºæ•™ç¨‹: <a href="http://82.157.231.110:3000/api/content?type=art" target="_blank">http://82.157.231.110:3000/api/content?type=art</a><br>
            â€¢ çƒ­ç‚¹è¯é¢˜: <a href="http://82.157.231.110:3000/api/content?type=hot" target="_blank">http://82.157.231.110:3000/api/content?type=hot</a>
        </div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status-display');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        async function checkStatus() {
            log('æ­£åœ¨æ£€æŸ¥æœåŠ¡çŠ¶æ€...');
            try {
                const response = await fetch('http://82.157.231.110:3000/health', {
                    method: 'GET',
                    timeout: 5000
                });
                if (response.ok) {
                    const data = await response.json();
                    showStatus('âœ… æœåŠ¡è¿è¡Œæ­£å¸¸ï¼', 'success');
                    log('æœåŠ¡çŠ¶æ€: æ­£å¸¸è¿è¡Œ');
                } else {
                    showStatus('âŒ æœåŠ¡å“åº”å¼‚å¸¸', 'error');
                    log('æœåŠ¡çŠ¶æ€: å“åº”å¼‚å¸¸');
                }
            } catch (error) {
                showStatus('âŒ æœåŠ¡æœªè¿è¡Œæˆ–æ— æ³•è®¿é—®', 'error');
                log('æœåŠ¡çŠ¶æ€: æ— æ³•è¿æ¥');
            }
        }

        function startService() {
            showStatus('ğŸ”„ æ­£åœ¨å¯åŠ¨æœåŠ¡... è¯·é€šè¿‡è…¾è®¯äº‘æ§åˆ¶å°æ‰§è¡Œå¯åŠ¨å‘½ä»¤', 'info');
            log('è¯·åœ¨è…¾è®¯äº‘æ§åˆ¶å°æ‰§è¡Œ: cd /www/wwwroot/tea-api && nohup python app.py > server.log 2>&1 &');
        }

        function stopService() {
            showStatus('ğŸ”„ æ­£åœ¨åœæ­¢æœåŠ¡... è¯·é€šè¿‡è…¾è®¯äº‘æ§åˆ¶å°æ‰§è¡Œåœæ­¢å‘½ä»¤', 'info');
            log('è¯·åœ¨è…¾è®¯äº‘æ§åˆ¶å°æ‰§è¡Œ: pkill -f "python app.py"');
        }

        async function testAPI() {
            log('å¼€å§‹æµ‹è¯•æ‰€æœ‰APIæ¥å£...');
            const endpoints = [
                { name: 'å¥åº·æ£€æŸ¥', url: 'http://82.157.231.110:3000/health' },
                { name: 'æ¨èå†…å®¹', url: 'http://82.157.231.110:3000/api/content?type=recommend' },
                { name: 'èŒ¶å¶æ–°é—»', url: 'http://82.157.231.110:3000/api/content?type=news' },
                { name: 'èŒ¶è‰ºæ•™ç¨‹', url: 'http://82.157.231.110:3000/api/content?type=art' },
                { name: 'çƒ­ç‚¹è¯é¢˜', url: 'http://82.157.231.110:3000/api/content?type=hot' }
            ];

            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint.url, { timeout: 5000 });
                    if (response.ok) {
                        log(`âœ… ${endpoint.name}: æ­£å¸¸`);
                    } else {
                        log(`âŒ ${endpoint.name}: å“åº”é”™è¯¯ (${response.status})`);
                    }
                } catch (error) {
                    log(`âŒ ${endpoint.name}: è¿æ¥å¤±è´¥`);
                }
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.onload = function() {
            log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹æ£€æŸ¥æœåŠ¡çŠ¶æ€...');
            checkStatus();
        };
    </script>
</body>
</html> 